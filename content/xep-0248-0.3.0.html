<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>XEP-0248: PubSub Collection Nodes</title><style type="text/css">
/* don't mind this hack */
nav#toc h2:before {
display: none;
content: "XEP-0248";
}
        </style><link rel="stylesheet" type="text/css" href="xmpp.css"><link href="prettify.css" type="text/css" rel="stylesheet"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico"><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0"><meta name="DC.Title" content="PubSub Collection Nodes"><meta name="DC.Creator" content="Peter Saint-Andre"><meta name="DC.Creator" content="Ralph Meijer"><meta name="DC.Creator" content="Brian Cully"><meta name="DC.Description" content="This specification defines the nature and handling of collection nodes in the XMPP publish-subscribe extension."><meta name="DC.Publisher" content="XMPP Standards Foundation"><meta name="DC.Contributor" content="XMPP Extensions Editor"><meta name="DC.Date" content="2021-08-03"><meta name="DC.Type" content="XMPP Extension Protocol"><meta name="DC.Format" content="XHTML"><meta name="DC.Identifier" content="XEP-0248"><meta name="DC.Language" content="en"><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright © 1999 – 2020 by the XMPP Standards Foundation (XSF)."></head><body onload="prettyPrint()"><h1>XEP-0248: PubSub Collection Nodes</h1><div class="docmeta-wrap"><dl id="docmeta" class="compact"><dt>Abstract</dt><dd>This specification defines the nature and handling of collection nodes in the XMPP publish-subscribe extension.</dd><dt>Authors</dt><dd><ul class="authors"><li>Peter Saint-Andre</li><li>Ralph Meijer</li><li>Brian Cully</li></ul></dd><dt>Copyright</dt><dd>© 1999 – 2021 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</dd><dt>Status</dt><dd><p>Deferred</p><div id="status-notice" class="deferred standards track">WARNING: This document has been automatically Deferred after 12 months of inactivity in its previous Experimental state. Implementation of the protocol described herein is not recommended for production systems. However, exploratory implementations are encouraged to resume the standards process.</div></dd><dt>Type</dt><dd>Standards Track</dd><dt>Version</dt><dd>0.3.0 (2021-08-03)</dd></dl><div class="timeline-wrap"><div class="timeline-head">Document Lifecycle</div><ol class="timeline"><li>Experimental</li><li class="current inserted">Deferred</li><li>Proposed</li><li>Draft</li><li>Final</li></ol></div></div><nav id="toc"><a href="#top"><h2>Table of Contents</h2></a><ol class="toc"><li><a href="#introduction">Introduction</a></li><li><a href="#scope">Scope</a></li><li><a href="#glossary">Glossary</a></li><li><a href="#preliminaries">Preliminaries</a><ol><li><a href="#collection-nodes">Collection Nodes</a></li></ol></li><li><a href="#entity">Entity Use Cases</a><ol><li><a href="#disco-support">Discovering Support for Collection Nodes</a></li><li><a href="#disco-nodes">Discover Nodes</a><ol><li><a href="#disco-nodes-request">Request</a></li><li><a href="#disco-nodes-success">Success Case</a></li></ol></li><li><a href="#notifications">Notifications</a><ol><li><a href="#notify">Generating Notifications for Collections</a><ol><li><a href="#notify-items">Notifications about Items</a></li><li><a href="#notify-items">Notifications about Nodes</a></li></ol></li><li><a href="#notify-associate-dissociate">Node Association and Dissociation</a><ol><li><a href="#notify-metadata">Including Node Meta-Data</a></li></ol></li></ol></li></ol></li><li><a href="#subscriber">Subscriber Use Cases</a><ol><li><a href="#subscribe">Subscribe to a Collection Node</a><ol><li><a href="#subscribe-request">Request</a></li><li><a href="#subscribe-success">Success Case</a></li><li><a href="#subscribe-errors">Error Cases</a></li></ol></li><li><a href="#retrieve-items">Retrieving Items on Collection Nodes</a><ol><li><a href="#retrieve-request">Request</a></li><li><a href="#retrieve-request">Success Case</a></li><li><a href="#retrieve-errors">Error Cases</a></li></ol></li></ol></li><li><a href="#owner">Owner Use Cases</a><ol><li><a href="#createnode">Create a New Collection Node</a><ol><li><a href="#createnode-request">Request</a></li><li><a href="#createnode-success">Success Case</a></li><li><a href="#createnode-errors">Error Cases</a><ol><li><a href="#error-create-unsupported">Collection Nodes Unsupported</a></li><li><a href="#error-create-notallowed">Collection Nodes Can't be Created</a></li><li><a href="#error-create-forbidden">Entity is not Authorized</a></li></ol></li></ol></li><li><a href="#configure-collection">Configuring a Collection Node</a><ol><li><a href="#configure-request">Request</a></li><li><a href="#configure-success">Success Case</a></li><li><a href="#configure-errors">Error Cases</a><ol><li><a href="#error-children-on-leaf">Configuring a Leaf Node with Children</a></li><li><a href="#error-config-not-authorized">Entity is not Authorized</a></li><li><a href="#error-max-children">Maximum Number of Children Exceeded</a></li><li><a href="#error-node-type">Changing Node Types</a></li><li><a href="#error-collection-cycle">Creating a Cycle in the Collection</a></li></ol></li></ol></li><li><a href="#delete-node">Deleting a Collection Node</a><ol><li><a href="#delete-node-request">Request</a></li><li><a href="#delete-node-success">Success Case</a></li><li><a href="#delete-node-errors">Error Cases</a><ol><li><a href="#delete-root-node">Deleting the Root Node</a></li></ol></li></ol></li><li><a href="#associate-node">Associating a Node to a Collection</a><ol><li><a href="#associate-request">Request</a></li><li><a href="#associate-success">Success Case</a></li><li><a href="#associate-errors">Error Cases</a><ol><li><a href="#error-assoc-auth">Entity is not Authorized</a></li><li><a href="#error-assoc-too-many-nodes">Maximum Number of Children Exceeded</a></li><li><a href="#error-assoc-cycle">Creating a Cycle in the Collection</a></li></ol></li></ol></li><li><a href="#associate-node">Dissociating a Node from a Collection</a><ol><li><a href="#dissociate-request">Request</a></li><li><a href="#dissociate-success">Success Case</a></li><li><a href="#dissociate-errors">Error Cases</a><ol><li><a href="#error-dissoc-not-assoc">Node is not Associated</a></li><li><a href="#error-dissoc-auth">Entity is not Authorized</a></li></ol></li></ol></li></ol></li><li><a href="#impl-notes">Implementation Notes</a><ol><li><a href="#root">Root Node</a></li><li><a href="#imple-delete">Handling Collection Node Deletion</a></li><li><a href="#impl-config">Updating Node Configuration When Associating or Dissociating Nodes</a></li></ol></li><li><a href="#security">Security Considerations</a><ol><li><a href="#security-access">Access Models</a></li></ol></li><li><a href="#iana">IANA Considerations</a></li><li><a href="#registrar">XMPP Registrar Considerations</a><ol><li><a href="#registrar-features">Service Discovery Features</a></li><li><a href="#registrar-formtypes">Field Standardization</a></li><li><a href="#registrar-shim">SHIM Headers</a></li></ol></li><li><a href="#schema">XML Schema</a></li><li><a href="#acknowledgements">Acknowledgements</a></li></ol><h6><a href="#appendices">Appendices</a></h6><ol class="toc-appendices"><li><a href="#appendix-docinfo">Document Information</a></li><li><a href="#appendix-authorinfo">Author Information</a></li><li><a href="#appendix-legal">Legal Notices</a></li><li><a href="#appendix-xmpp">Relation to XMPP</a></li><li><a href="#appendix-discuss">Discussion Venue</a></li><li><a href="#appendix-conformance">Requirements Conformance</a></li><li><a href="#appendix-notes">Notes</a></li><li><a href="#appendix-revs">Revision History</a></li><li><a href="#appendix-biblatex">Bib(La)Tex Entry</a></li></ol></nav><h2 id="introduction">1.
       Introduction<a class="anchor-link" href="#introduction"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style=""><span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0060.html">Publish-Subscribe (XEP-0060)</a></span>  [<a href="#nt-idm74">1</a>] defines an XMPP protocol extension for generic publish-subscribe features. However, it only allows notifications from nodes to which an entity is directly subscribed. It is useful in some circumstances to describe a relationship between nodes so that a publish on one node may be delivered via another node. For instance, if an entity is interested in notifications from a set of nodes the entity would discover each node somehow and then subscribe to them. With collection nodes, the entity would subscribe only to the collection which links the desired nodes, simplifying the subscription process.</p>

    <p class="" style="">In addition to simplifying the subscriber's usage, collection nodes also allow the owner to describe almost any type of relationship between nodes. Using various access models on different nodes the owner can also create almost any desired authorization semantics on a set of leaf nodes.</p>

    <p class="em" style="">Note: Any use cases not described herein are described in <span class="ref">XEP-0060</span>. Also, this document does not show error flows related to the generic publish-subscribe use cases referenced herein, since they are exhaustively defined in <span class="ref">XEP-0060</span>. The reader is referred to <span class="ref">XEP-0060</span> for all relevant protocol details related to the XMPP publish-subscribe extension.</p>
  <h2 id="scope">2.
       Scope<a class="anchor-link" href="#scope"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style="">This documents addresses the common requirements regarding configuration, publishing, subscribing, and notification semantics of collection nodes.</p>
  <h2 id="glossary">3.
       Glossary<a class="anchor-link" href="#glossary"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style="">The following terms are used in this document to refer to collection node-specific features.</p>

    <p class="em" style="">Note: some of these terms are specified in greater detail within the body of this document.</p>

    <div class="indent"><dl>
      
        <dt><strong>Collection Node</strong></dt>
        <dd>A type of node that contains other nodes but no published items (<em>c.f.</em> Leaf Node).</dd>
      

      
        <dt><strong>Leaf Node</strong></dt>
        <dd>A type of node that contains published items but no other nodes (<em>c.f.</em> Collection Node).</dd>
      

      
        <dt><strong>Node Graph</strong></dt>
        <dd>The network of nodes emitting from a given node which contains all its descendants.</dd>
      

      
        <dt><strong>Root Node</strong></dt>
        <dd>An anonymous collection node used as the <em>de facto</em> beginning of a service's node graph.</dd>
      

      
        <dt><strong>Subscription Depth</strong></dt>
        <dd>How deep the collection node graph will be traversed when determining whether notifications will be sent. May be any integer, 0 or greater, or "all".</dd>
      

      
        <dt><strong>Subscription Type</strong></dt>
        <dd>The type of notification, either "nodes", "items", or "all" which the subscriber is interested in.</dd>
      
    </dl></div>
  <h2 id="preliminaries">4.
       Preliminaries<a class="anchor-link" href="#preliminaries"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="collection-nodes">4.1 Collection Nodes<a class="anchor-link" href="#collection-nodes"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">Collection nodes link nodes together to unify notifications from a set of collection or leaf nodes. An entity can subscribe to the collection and receive notifications of any associated leaf nodes.</p>

      <p class="" style="">A collection node can link with any other node in order to create a directed acyclic graph (DAG). Collection nodes MUST NOT be linked in such a way as to produce a cyclic graph (<em>i.e.</em>, they cannot link to nodes that eventually link back to the initial node).</p>

      <p class="" style="">Collection nodes only contain other nodes and MUST NOT contain published items (therefore a collection MUST NOT support the "publish" feature or related features such as "persistent-items").</p>
    </div>
  <h2 id="entity">5.
       Entity Use Cases<a class="anchor-link" href="#entity"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="disco-support">5.1 Discovering Support for Collection Nodes<a class="anchor-link" href="#disco-support"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">An entity might wish to discover if a service implements collection nodes; in order to do so, it sends a service discovery information ("disco#info") query to the component's JID using <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm119">2</a>]. If a service supports collection nodes it MUST return a "pubsub#collections" feature. In addition, if the service supports associating a node with more than one collection it MUST return a feature of "pubsub#multi-collections".</p>

      <figure class="code-example" id="example-1"><figcaption><strong>Example 1.</strong> Entity requests features from a service<a class="anchor-link" href="#example-1"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></figure>

      <figure class="code-example" id="example-2"><figcaption><strong>Example 2.</strong> Service responds with support for collections<a class="anchor-link" href="#example-2"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='http://jabber.org/protocol/pubsub#collections'/&gt;
    &lt;feature var='http://jabber.org/protocol/pubsub#multi-collections'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
</pre></figure>
    </div>

    <div class="indent"><h3 id="disco-nodes">5.2 Discover Nodes<a class="anchor-link" href="#disco-nodes"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">The service discovery items ("disco#items") protocol enables an entity to query a service for a list of associated items, which, in the case of collection nodes would consist of the children associated with a given node.</p>

      <div class="indent"><h4 id="disco-nodes-request">5.2.1 Request<a class="anchor-link" href="#disco-nodes-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-3"><figcaption><strong>Example 3.</strong> Entity requests child node discovery<a class="anchor-link" href="#example-3"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='blogs'/&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="disco-nodes-success">5.2.2 Success Case<a class="anchor-link" href="#disco-nodes-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-4"><figcaption><strong>Example 4.</strong> Service responds with child nodes<a class="anchor-link" href="#example-4"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='blogs'&gt;
    &lt;item node='Romeoance'
          name='Letters to my Beloved'
          jid='pubsub.shakespeare.lit'/&gt;
    &lt;item node='Julliennui'
          name='A Rose by Another Name'
          jid='pubsub.shakespeare.lit'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
</pre></figure>
      </div>
    </div>

    <div class="indent"><h3 id="notifications">5.3 Notifications<a class="anchor-link" href="#notifications"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <div class="indent"><h4 id="notify">5.3.1 Generating Notifications for Collections<a class="anchor-link" href="#notify"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If a notification on a child node is created and then delivered via the collection then the notifications generated by the service MUST contain additional information. The 'node' attribute of the &lt;item/&gt; or &lt;node/&gt; element contained in the notification message MUST specify the node identifier of the node that generated the notification (not the collection) and the &lt;message/&gt; stanza MUST contain <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0131.html">Stanza Headers and Internet Metadata (XEP-0131)</a></span>  [<a href="#nt-idm134">3</a>] that specifies the node identifier of the collection.</p>

        <p class="em" style="">Note: The delivery options (such as "pubsub#deliver_payloads") are determined by the publishing leaf node, not by the collection node. If the owner of a collection node sets delivery options for a collection node, the service SHOULD ignore those options and apply the options set for the leaf node that publishes an item.</p>

        <div class="indent"><h5 id="notify-items">5.3.1.1 Notifications about Items</h5>
          <p class="" style="">Item notifications are notifications about the contents of a leaf node, and are generated by a publish, retract, or purge request.</p>

          <figure class="code-example" id="example-5"><figcaption><strong>Example 5.</strong> Subscriber receives a publish notification from a collection<a class="anchor-link" href="#example-5"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;message to='francisco@denmark.lit' from='pubsub.shakespeare.lit'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;items node='princely_musings'&gt;
      &lt;item id='ae890ac52d0df67ed7cfdf51b644e901'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
  &lt;/event&gt;
  &lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
    &lt;header name='Collection'&gt;blogs&lt;/header&gt;
  &lt;/headers&gt;
&lt;/message&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="notify-items">5.3.1.2 Notifications about Nodes</h5>
          <p class="" style="">Node notifications are notifications about nodes themselves, and are generated by a create, delete, or configure request.</p>

          <figure class="code-example" id="example-6"><figcaption><strong>Example 6.</strong> Subscriber receives a creation notification from a collection<a class="anchor-link" href="#example-6"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;message to='francisco@denmark.lit' from='pubsub.shakespeare.lit'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;create node='princely_musings'/&gt;
  &lt;/event&gt;
  &lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
    &lt;header name='Collection'&gt;blogs&lt;/header&gt;
  &lt;/headers&gt;
&lt;/message&gt;
</pre></figure>
        </div>
    </div>

      <div class="indent"><h4 id="notify-associate-dissociate">5.3.2 Node Association and Dissociation<a class="anchor-link" href="#notify-associate-dissociate"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If a collection node is configured to send notification of node associations and disassociations, the service shall send an event that contains a &lt;collection/&gt; element whose 'node' attribute specifies the NodeID of the collection; this element in turn contains an &lt;associate/&gt; or &lt;dissociate/&gt; element whose 'node' attribute specifies the NodeID of node that has been associated with the collection.</p>

        <figure class="code-example" id="example-7"><figcaption><strong>Example 7.</strong> Notification of node association<a class="anchor-link" href="#example-7"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode1'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-node-id'&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></figure>

        <figure class="code-example" id="example-8"><figcaption><strong>Example 8.</strong> Notification of node dissociation<a class="anchor-link" href="#example-8"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode1'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;dissociate node='old-node-id'&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></figure>

        <div class="indent"><h5 id="notify-metadata">5.3.2.1 Including Node Meta-Data</h5>
          <p class="" style="">The notification event MAY also include the node metadata, formatted using the <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0004.html">Data Forms (XEP-0004)</a></span>  [<a href="#nt-idm151">4</a>] protocol.</p>

          <figure class="code-example" id="example-9"><figcaption><strong>Example 9.</strong> Notification of node association<a class="anchor-link" href="#example-9"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode2'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-node-id'&gt;
        &lt;x xmlns='jabber:x:data' type='result'&gt;
          &lt;field var='FORM_TYPE' type='hidden'&gt;
            &lt;value&gt;http://jabber.org/protocol/pubsub#meta-data&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#creation_date'&gt;
            &lt;value&gt;2003-07-29T22:56Z&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#creator'&gt;
            &lt;value&gt;hamlet@denmark.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#description'&gt;
            &lt;value&gt;Atom feed for my blog.&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#language'&gt;
            &lt;value&gt;en&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#contact'&gt;
            &lt;value&gt;bard@shakespeare.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#owner'&gt;
            &lt;value&gt;hamlet@denmark.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#title'&gt;
            &lt;value&gt;Princely Musings (Atom).&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#type'
            &gt;&lt;value&gt;http://www.w3.org/2005/Atom&lt;/value&gt;
          &lt;/field&gt;
        &lt;/x&gt;
      &lt;/node&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></figure>
        </div>
      </div>
    </div>
  <h2 id="subscriber">6.
       Subscriber Use Cases<a class="anchor-link" href="#subscriber"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="subscribe">6.1 Subscribe to a Collection Node<a class="anchor-link" href="#subscribe"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">A service that implements collection nodes SHOULD allow entities to subscribe to collection nodes (subject to access models and local security policies).</p>
      <p class="" style="">In addition to the subscription configuration options already defined in <span class="ref">XEP-0060</span>, there are two subscription configuration options specific to collection nodes:</p>
      <ul class="" style="">
        <li class="" style="">
          <p class="" style=""><strong>pubsub#subscription_type</strong></p>
          <p class="" style="">This subscription option enables the subscriber to subscribe either to notifications about items or notifications about nodes.</p>

          <p class="" style="">If the subscription type is "items", the subscriber shall be notified whenever any node contained in the collection has an item published to it, retracted from it, or the node is purged, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">If the subscription type is "nodes", the subscriber shall be notified whenever a new node is added to the collection, removed from the collection, or the configuration of a node within the collection has changed, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">If the subscription type is "all", the subscriber shall be notified about both "items" and "nodes" types of events, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">The default value of this subscription option SHOULD be "nodes".</p>
        </li>

        <li class="" style="">
          <p class="" style=""><strong>pubsub#subscription_depth</strong></p>

          <p class="" style="">This subscription option enables the subscriber to specify how far to traverse the node graph when determining whether a notification will be sent. It may be any integer value, 0 or greater, or the value "all" which means that any node within the collection will generate a notification.</p>

          <p class="" style="">The default value of this subscription option SHOULD be "1".</p>
        </li>
      </ul>
      <p class="" style="">In order to subscribe to a collection node, an entity MUST send a subscription request to the node; the subscription request MAY include subscription options, but this is not strictly necessary (especially if the entity does not wish to override the default settings for the "pubsub#subscription_type" and "pubsub#subscription_depth" options).</p>

      <div class="indent"><h4 id="subscribe-request">6.1.1 Request<a class="anchor-link" href="#subscribe-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-10"><figcaption><strong>Example 10.</strong> Entity subscribes to a collection node (no configuration)<a class="anchor-link" href="#example-10"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'
               node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>

        <p class="" style="">The subscriber will now receive notification of new first-level nodes created within the "blogs" collection.</p>

        <figure class="code-example" id="example-11"><figcaption><strong>Example 11.</strong> Entity subscribes to a collection node (with configuration)<a class="anchor-link" href="#example-11"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'
               node='blogs'/&gt;
    &lt;options&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#subscribe_options&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#subscription_type'&gt;
          &lt;value&gt;items&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#subscription_depth'&gt;
          &lt;value&gt;all&lt;/value&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/options&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="subscribe-success">6.1.2 Success Case<a class="anchor-link" href="#subscribe-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If the service allows the subscription it MUST inform the requesting entity that it is now subscribed.</p>
        <figure class="code-example" id="example-12"><figcaption><strong>Example 12.</strong> Service responds with success<a class="anchor-link" href="#example-12"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscription node='blogs'
                  jid='francisco@denmark.lit'
                  subscription='subscribed'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="subscribe-errors">6.1.3 Error Cases<a class="anchor-link" href="#subscribe-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">A service MAY allow an entity to subscribe to a collection node in two ways, once with a subscription of type "nodes" (to receive notification of any new nodes added to the collection or the entire tree) and once with a subscription of type "items" (to receive all items published within the tree). However, a service SHOULD NOT allow an entity to subscribe twice to a collection node (once with a subscription depth of "1" and once with a subscription depth of "all") for the same subscription type, since two such subscriptions are unnecessary (a depth of "all" includes by definition a depth of "1"); in this case the service SHOULD return a &lt;conflict/&gt; error to the requesting entity.</p>

        <figure class="code-example" id="example-13"><figcaption><strong>Example 13.</strong> Service does not allow mulitple subscriptions to the same node<a class="anchor-link" href="#example-13"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;error type='cancel'&gt;
    &lt;conflict xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>

        <p class="" style="">Depending on the nature of the node graph, a subscription type of "items" and depth of "all" may result in an extremely large number of notifications. Therefore, a service MAY disallow such a combination of subscription options, in which case it MUST return a &lt;not-allowed/&gt; error to the requesting entity.</p>

        <figure class="code-example" id="example-14"><figcaption><strong>Example 14.</strong> Service does not allow requested options<a class="anchor-link" href="#example-14"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
      </div>
    </div>

    <div class="indent"><h3 id="retrieve-items">6.2 Retrieving Items on Collection Nodes<a class="anchor-link" href="#retrieve-items"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">When an entity requests items on a collection node the service SHOULD return the items on any leaf nodes associated with it subject to the access model of the collection node.</p>

      <div class="indent"><h4 id="retrieve-request">6.2.1 Request<a class="anchor-link" href="#retrieve-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-15"><figcaption><strong>Example 15.</strong> Subscriber requests all items on a collection<a class="anchor-link" href="#example-15"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='items1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="retrieve-request">6.2.2 Success Case<a class="anchor-link" href="#retrieve-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">When a collection contains multiple nodes with items it MUST return multiple &lt;items/&gt; elements, one per node.</p>

        <figure class="code-example" id="example-16"><figcaption><strong>Example 16.</strong> Service returns items on leaf nodes<a class="anchor-link" href="#example-16"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='items1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='Romeoance'&gt;
      &lt;item id='368866411b877c30064a5f62b917cffe'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
    &lt;items node='Julliennui'&gt;
      &lt;item id='3300659945416e274474e469a1f0154c'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="retrieve-errors">6.2.3 Error Cases<a class="anchor-link" href="#retrieve-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">Depending on the nature of the node graph it may be expensive to allow item retrieval from a collection node. Therefore the service MAY disallow item retrieval via collection nodes, in which case it MUST return a &lt;feature-not-implemented/&gt; error to the requesting entity.</p>

        <figure class="code-example" id="example-17"><figcaption><strong>Example 17.</strong> Service cannot fulfil request<a class="anchor-link" href="#example-17"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='items1'&gt;
  &lt;error type='cancel'&gt;
    &lt;feature-not-implemented xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
      </div>
    </div>
  <h2 id="owner">7.
       Owner Use Cases<a class="anchor-link" href="#owner"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="createnode">7.1 Create a New Collection Node<a class="anchor-link" href="#createnode"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">To create a new collection node, the requesting entity MUST include a Data Form containing a "pubsub#node_type" field whose &lt;value/&gt; element contains "collection". The default value for "pubsub#node_type" SHOULD be "leaf".</p>

      <div class="indent"><h4 id="createnode-request">7.1.1 Request<a class="anchor-link" href="#createnode-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-18"><figcaption><strong>Example 18.</strong> Entity requests a new collection node<a class="anchor-link" href="#example-18"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='create3'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;create node='announcements'/&gt;
    &lt;configure&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#node_type'&gt;&lt;value&gt;collection&lt;/value&gt;&lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="createnode-success">7.1.2 Success Case<a class="anchor-link" href="#createnode-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-19"><figcaption><strong>Example 19.</strong> Service responds with success<a class="anchor-link" href="#example-19"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'/&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="createnode-errors">7.1.3 Error Cases<a class="anchor-link" href="#createnode-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">In addition to the errors already defined for leaf node creation, there are several reasons why the collection node creation request might fail:</p>

        <ol start="" class="" style="">
          <li class="" style="">The service does not support collection nodes.</li>
          <li class="" style="">The service does not support creation of collection nodes.</li>
          <li class="" style="">The requesting entity does not have sufficient privileges to create collection nodes.</li>
        </ol>

        <p class="" style="">These error cases are described more fully in the following sections.</p>

        <div class="indent"><h5 id="error-create-unsupported">7.1.3.1 Collection Nodes Unsupported</h5>
          <p class="" style="">If the service does not support collection nodes, it MUST respond with a &lt;feature-not-implemented/&gt; error, specifying a pubsub-specific error condition of &lt;unsupported/&gt; and a feature of "collections".</p>

          <figure class="code-example" id="example-20"><figcaption><strong>Example 20.</strong> Service does not support collection nodes<a class="anchor-link" href="#example-20"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'&gt;
  &lt;error type='cancel'&gt;
    &lt;feature-not-implemented xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;unsupported xmlns='http://jabber.org/protocol/pubsub#errors'
                 feature='collections'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-create-notallowed">7.1.3.2 Collection Nodes Can't be Created</h5>
          <p class="" style="">If the service supports collection nodes but does not allow new collection nodes to be created, it MUST respond with a &lt;not-allowed/&gt; error.</p>

          <figure class="code-example" id="example-21"><figcaption><strong>Example 21.</strong> Service does not allow creation of collection nodes<a class="anchor-link" href="#example-21"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='hamlet@denmark.lit/elsinore'
    to='pubsub.shakespeare.lit'
    id='create3'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-create-forbidden">7.1.3.3 Entity is not Authorized</h5>
          <p class="" style="">If the requesting entity has insufficient privileges to create new collections, the service MUST respond with a &lt;forbidden/&gt; error.</p>

          <figure class="code-example" id="example-22"><figcaption><strong>Example 22.</strong> Requesting entity has insufficient privileges to create collection nodes<a class="anchor-link" href="#example-22"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'&gt;
  &lt;error type='auth'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>
      </div>
    </div>

    <div class="indent"><h3 id="configure-collection">7.2 Configuring a Collection Node<a class="anchor-link" href="#configure-collection"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <div class="indent"><h4 id="configure-request">7.2.1 Request<a class="anchor-link" href="#configure-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">In addition to the node configuration options specified in <span class="ref">XEP-0060</span>, there are three additional node configuration options that a service which supports collection nodes MUST supply.</p>

        <ul class="" style="">
          <li class="" style=""><strong>pubsub#node_type</strong>
          <p class="" style="">Whether this is a "leaf" or "collection" node.</p></li>
          <li class="" style=""><strong>pubsub#collection</strong>
          <p class="" style="">The parents of this node.</p></li>
          <li class="" style=""><strong>pubsub#children</strong>
          <p class="" style="">The children of this node.</p></li>
        </ul>

        <p class="" style="">To associate the root node to the collection the &lt;value/&gt; element MUST be empty.</p>

      <p class="" style="">A service MAY offer some node configuration options that are specific to collection nodes and SHOULD NOT be provided in configuration forms related to leaf nodes. The following are RECOMMENDED:</p>

      <ul class="" style="">
        <li class="" style=""><strong>pubsub#children_association_policy</strong>
        <p class="" style="">The policy regarding who may associate child nodes with the collection (values: all, owner, whitelist).</p></li>
        <li class="" style=""><strong>pubsub#children_association_whitelist</strong>
        <p class="" style="">The whitelist of entities that may associate child nodes with the collection.</p></li>
        <li class="" style=""><strong>pubsub#children_max</strong>
        <p class="" style="">The maximum number of child nodes that may be associated with a collection.</p></li>
      </ul>


        <figure class="code-example" id="example-23"><figcaption><strong>Example 23.</strong> Entity configures a collection node<a class="anchor-link" href="#example-23"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='config1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;configure node='blogs'&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#node_type'&gt;
          &lt;value&gt;collection&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#children'&gt;
          &lt;value&gt;Romeoance&lt;/value&gt;
          &lt;value&gt;Julliennui&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#collection'&gt;
          &lt;value/&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="configure-success">7.2.2 Success Case<a class="anchor-link" href="#configure-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <figure class="code-example" id="example-24"><figcaption><strong>Example 24.</strong> Service successfully updates configuration<a class="anchor-link" href="#example-24"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'/&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="configure-errors">7.2.3 Error Cases<a class="anchor-link" href="#configure-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <div class="indent"><h5 id="error-children-on-leaf">7.2.3.1 Configuring a Leaf Node with Children</h5>
          <p class="" style="">Leaf nodes only contain published items and MUST NOT have any children. If an entity attempts to add children to a leaf node (either via "pubsub#children" on the leaf node or "pubsub#collection" on another node) the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <figure class="code-example" id="example-25"><figcaption><strong>Example 25.</strong> Attempt to add a leaf node as the parent of another node<a class="anchor-link" href="#example-25"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-config-not-authorized">7.2.3.2 Entity is not Authorized</h5>
          <p class="" style="">If the requesting entity is not authorized to add the node to a collection then the service MUST return a &lt;forbidden/&gt; error.</p>

          <figure class="code-example" id="example-26"><figcaption><strong>Example 26.</strong> Entity is not authorized to add node to a collection<a class="anchor-link" href="#example-26"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-max-children">7.2.3.3 Maximum Number of Children Exceeded</h5>
          <p class="" style="">If the configuration would exceed the maximum number of children allowed on a node, either because the node's "pubsub#children" exceeds its own "pubsub#children_max" value or because adding this node to a parent via "pubsub#collection" would exceed the parent's "pubsub#children_max" value, the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;max-nodes-exceeded/&gt;.</p>

          <figure class="code-example" id="example-27"><figcaption><strong>Example 27.</strong> Node would contain too many children<a class="anchor-link" href="#example-27"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;max-nodes-exceeded xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-node-type">7.2.3.4 Changing Node Types</h5>
          <p class="" style="">The service MUST NOT allow the node type to be changed. If it is attempted the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;</p>

          <figure class="code-example" id="example-28"><figcaption><strong>Example 28.</strong> Attempt to change node type<a class="anchor-link" href="#example-28"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-collection-cycle">7.2.3.5 Creating a Cycle in the Collection</h5>
          <p class="" style="">The service MUST NOT allow a cycle to be created in the node graph (<em>e.g.</em>, node A to B to C to A). If an entity attempts to submit a configuration that would create a cycle the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <figure class="code-example" id="example-29"><figcaption><strong>Example 29.</strong> Cycle created in node graph<a class="anchor-link" href="#example-29"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>
      </div>
    </div>

    <div class="indent"><h3 id="delete-node">7.3 Deleting a Collection Node<a class="anchor-link" href="#delete-node"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <div class="indent"><h4 id="delete-node-request">7.3.1 Request<a class="anchor-link" href="#delete-node-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If a service supports collection node creation it MUST support collection node deletion.</p>

        <figure class="code-example" id="example-30"><figcaption><strong>Example 30.</strong> Owner attempts to delete a collection node<a class="anchor-link" href="#example-30"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='delete1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;delete node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="delete-node-success">7.3.2 Success Case<a class="anchor-link" href="#delete-node-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If no error occurs, the service MUST inform the owner of success.</p>

        <figure class="code-example" id="example-31"><figcaption><strong>Example 31.</strong> Collection node was deleted<a class="anchor-link" href="#example-31"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='delete1'/&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="delete-node-errors">7.3.3 Error Cases<a class="anchor-link" href="#delete-node-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <div class="indent"><h5 id="delete-root-node">7.3.3.1 Deleting the Root Node</h5>
          <p class="" style="">If the requesting entity attempts to delete the root node, the service MUST return a &lt;not-allowed/&gt; error.</p>

          <figure class="code-example" id="example-32"><figcaption><strong>Example 32.</strong> Node is the root<a class="anchor-link" href="#example-32"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='delete1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>
      </div>
    </div>

    <div class="indent"><h3 id="associate-node">7.4 Associating a Node to a Collection<a class="anchor-link" href="#associate-node"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <div class="indent"><h4 id="associate-request">7.4.1 Request<a class="anchor-link" href="#associate-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
      <p class="" style="">A service MAY allow collection nodes to have children associated with them without changing the rest of the configuration. If the service allows this an entity can send and &lt;associate/&gt; element with a 'node' attribute that contains the child node within a &lt;collection/&gt; element that posesses a 'node' attribute containing the parent node to the service.</p>

        <figure class="code-example" id="example-33"><figcaption><strong>Example 33.</strong> Entity requests node association<a class="anchor-link" href="#example-33"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='assoc1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-child-node'/&gt;
    &lt;/collection&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="associate-success">7.4.2 Success Case<a class="anchor-link" href="#associate-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If the service allows the node association then it MUST confirm the association with an empty result.</p>

        <figure class="code-example" id="example-34"><figcaption><strong>Example 34.</strong> Service associates the node<a class="anchor-link" href="#example-34"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='assoc1'/&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="associate-errors">7.4.3 Error Cases<a class="anchor-link" href="#associate-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <div class="indent"><h5 id="error-assoc-auth">7.4.3.1 Entity is not Authorized</h5>
          <figure class="code-example" id="example-35"><figcaption><strong>Example 35.</strong> Entity is not authorized to associate the node<a class="anchor-link" href="#example-35"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-assoc-too-many-nodes">7.4.3.2 Maximum Number of Children Exceeded</h5>
          <p class="" style="">If the configuration would exceed the maximum number of children allowed on a node, either because the node's "pubsub#children" exceeds its own "pubsub#children_max" value or because adding this node to a parent via "pubsub#collection" would exceed the parent's "pubsub#children_max" value, the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;max-nodes-exceeded/&gt;.</p>

          <figure class="code-example" id="example-36"><figcaption><strong>Example 36.</strong> Node would contain too many children<a class="anchor-link" href="#example-36"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;max-nodes-exceeded xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-assoc-cycle">7.4.3.3 Creating a Cycle in the Collection</h5>
          <p class="" style="">The service MUST NOT allow a cycle to be created in the node graph (<em>e.g</em>., node A to B to C to A). If an entity attempts to submit a configuration that would create a cycle the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <figure class="code-example" id="example-37"><figcaption><strong>Example 37.</strong> Cycle created in node graph<a class="anchor-link" href="#example-37"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>
      </div>
    </div>

    <div class="indent"><h3 id="associate-node">7.5 Dissociating a Node from a Collection<a class="anchor-link" href="#associate-node"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <div class="indent"><h4 id="dissociate-request">7.5.1 Request<a class="anchor-link" href="#dissociate-request"><abbr title="Link to this point in the document">¶</abbr></a></h4>
      <p class="" style="">A service MAY allow collection nodes to have children dissociated from them without changing the rest of the configuration. If the service allows this an entity can send and &lt;dissociate/&gt; element with a 'node' attribute that contains the child node within a &lt;collection/&gt; element that posesses a 'node' attribute containing the parent node to the service.</p>

        <figure class="code-example" id="example-38"><figcaption><strong>Example 38.</strong> Entity requests node dissociation<a class="anchor-link" href="#example-38"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='dissoc1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;dissociate node='old-child-node'/&gt;
    &lt;/collection&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="dissociate-success">7.5.2 Success Case<a class="anchor-link" href="#dissociate-success"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <p class="" style="">If the service allows the node dissociation then it MUST confirm the association with an empty result.</p>

        <figure class="code-example" id="example-39"><figcaption><strong>Example 39.</strong> Service dissociates the node<a class="anchor-link" href="#example-39"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='dissoc1'/&gt;
</pre></figure>
      </div>

      <div class="indent"><h4 id="dissociate-errors">7.5.3 Error Cases<a class="anchor-link" href="#dissociate-errors"><abbr title="Link to this point in the document">¶</abbr></a></h4>
        <div class="indent"><h5 id="error-dissoc-not-assoc">7.5.3.1 Node is not Associated</h5>
          <p class="" style="">If a dissociation is requested between two nodes that are not already associated then the service MUST return a &lt;bad-request/&gt; error.</p>

          <figure class="code-example" id="example-40"><figcaption><strong>Example 40.</strong> Node is not associated<a class="anchor-link" href="#example-40"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='dissoc1'&gt;
  &lt;error type='modify'&gt;
    &lt;bad-request xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>

        <div class="indent"><h5 id="error-dissoc-auth">7.5.3.2 Entity is not Authorized</h5>
          <figure class="code-example" id="example-41"><figcaption><strong>Example 41.</strong> Entity is not authorized to dissociate the node<a class="anchor-link" href="#example-41"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='dissoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></figure>
        </div>
      </div>
    </div>
  <h2 id="impl-notes">8.
       Implementation Notes<a class="anchor-link" href="#impl-notes"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="root">8.1 Root Node<a class="anchor-link" href="#root"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">To provide a starting point for service discovery a service SHOULD support a root node. A root node represents the node belonging to a given service and MUST be identified by the lack of a node identifier (<em>i.e.</em>, the address of the pubsub service itself, such as "pubsub.shakespeare.lit"). Because the root node is owned by the service itself an entity SHOULD NOT be allowed create, delete, or configure the root node.</p>

      <p class="" style="">If a node is created or configured without any parents specified, a service MAY automatically associate otherwise orphaned nodes directly to the root node. If a service automatically associates a node with the root it MUST reflect that in the node configuration data form.</p>

      <figure class="code-example" id="example-42"><figcaption><strong>Example 42.</strong> Entity subscribes to the root node<a class="anchor-link" href="#example-42"><abbr title="Link to this point in the document">¶</abbr></a></figcaption><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='root1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></figure>
    </div>

    <div class="indent"><h3 id="imple-delete">8.2 Handling Collection Node Deletion<a class="anchor-link" href="#imple-delete"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">Deletion of collection nodes can have a number of side effects due to implementation. Depending on the nature of the collection any of the following MAY happen when a collection node is deleted:</p>

      <ul class="" style="">
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are orphaned; meaning that they will have no parent node, but continue to exist.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are re-assigned as children of the root node.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are also deleted.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have at least one other node the child nodes MUST remain associated with remaining parent nodes.</li>
      </ul>
    </div>

    <div class="indent"><h3 id="impl-config">8.3 Updating Node Configuration When Associating or Dissociating Nodes<a class="anchor-link" href="#impl-config"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">Node configuration MUST always reflect the current state of the node graph. Because node configuration contains both a pointer to its parents as well as its children an update to a primary node's "pubsub#collection" value will change the value of the secondary node's "pubsub#children" value, and vice-versa. A service MAY send a notification of the configuration change on the secondary node to subscribers if "pubsub#notify_config" is enabled on the secondary node.</p>
    </div>
  <h2 id="security">9.
       Security Considerations<a class="anchor-link" href="#security"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <div class="indent"><h3 id="security-access">9.1 Access Models<a class="anchor-link" href="#security-access"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <p class="" style="">Collection nodes can be used to associate almost any node within the service, but only the access model of the collection node itself is used to determine what an entity is allowed to see. Therefore care should be taken that nodes are not linked in such a way as to leak private data (e.g., from a "closed" leaf node through an "open" collection) unless that behavior is specifically desired.</p>
    </div>
  <h2 id="iana">10.
       IANA Considerations<a class="anchor-link" href="#iana"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-idm328">5</a>].</p>
  <h2 id="registrar">11.
       XMPP Registrar Considerations<a class="anchor-link" href="#registrar"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="em" style="">Note: These options are in addition to the standard options described in <span class="ref">XEP-0060</span> and related XEPs.</p>

    <div class="indent"><h3 id="registrar-features">11.1 Service Discovery Features<a class="anchor-link" href="#registrar-features"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <figure class="code"><figcaption></figcaption><pre class="prettyprint">
&lt;var&gt;
  &lt;name&gt;pubsub#collections&lt;/name&gt;
  &lt;desc&gt;Support for collection nodes&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/var&gt;
&lt;var&gt;
  &lt;name&gt;pubsub#multi-collections&lt;/name&gt;
  &lt;desc&gt;Support for multiple collections on a node&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/var&gt;
</pre></figure>
    </div>

    <div class="indent"><h3 id="registrar-formtypes">11.2 Field Standardization<a class="anchor-link" href="#registrar-formtypes"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <figure class="code"><figcaption></figcaption><pre class="prettyprint">
&lt;form_type&gt;
  &lt;name&gt;http://jabber.org/protocol/pubsub#subscribe_options&lt;/name&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
  &lt;desc&gt;Options for collection node subscription&lt;/desc&gt;
  &lt;field
      var='pubsub#subscription_depth'
      type='text-single'&gt;
      label='How far to traverse the node graph for notifications'/&gt;
  &lt;field
      var='pubsub#subscription_type'
      type='list-single'&gt;
    &lt;option label='Receive notification of items only'&gt;
      items
    &lt;/option&gt;
    &lt;option label='Receive notification of nodes only'&gt;
      nodes
    &lt;/option&gt;
    &lt;option label='Receive notification of items and nodes'&gt;
      all
    &lt;/option&gt;
  &lt;/field&gt;
&lt;/form_type&gt;
&lt;form_type&gt;
  &lt;name&gt;http://jabber.org/protocol/pubsub#node_config&lt;/name&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
  &lt;desc&gt;Options for collection node configuration&lt;/desc&gt;
  &lt;field
      var='pubsub#node_type'
      type='list-single'&gt;
    &lt;option label='The node contains items'&gt;
      leaf
    &lt;/option&gt;
    &lt;option label='The node contains other nodes'&gt;
      collection
    &lt;/option&gt;
  &lt;/field&gt;
  &lt;field
      var='pubsub#collection'
      type='text-multi'
      label='The collections of which this node is a child'/&gt;
  &lt;field
      var='pubsub#children'
      type='text-multi'
      label='The nodes of which this node is a parent'/&gt;
  &lt;field
      var='pubsub#children_association_policy'
      type='list-single'&gt;
    &lt;option label='Only the owners of this node may associate other nodes to this collection'&gt;
      owners
    &lt;/option&gt;
    &lt;option label='Only those on the children association whitelist may associate other nodes to this collection'&gt;
      whitelist
    &lt;/option&gt;
    &lt;option label='Anyone may associate nodes with this collection'&gt;
      all
    &lt;/option&gt;
  &lt;/field&gt;
  &lt;field
      var='pubsub#children_association_whitelist'
      type='jid-multi'
      label='JIDs who can associate nodes to this collection'/&gt;
  &lt;field
      var='pubsub#children_max'
      type='text-single'
      label='The maximum number of children for this collection'/&gt;
&lt;/form_type&gt;
</pre></figure>
    </div>

    <div class="indent"><h3 id="registrar-shim">11.3 SHIM Headers<a class="anchor-link" href="#registrar-shim"><abbr title="Link to this point in the document">¶</abbr></a></h3>
      <figure class="code"><figcaption></figcaption><pre class="prettyprint">
&lt;header&gt;
  &lt;name&gt;Collection&lt;/name&gt;
  &lt;desc&gt;The node of subscription that sent a notification&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/header&gt;
</pre></figure>
    </div>
  <h2 id="schema">12.
       XML Schema<a class="anchor-link" href="#schema"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style="">REQUIRED.</p>
  <h2 id="acknowledgements">13.
       Acknowledgements<a class="anchor-link" href="#acknowledgements"><abbr title="Link to this point in the document">¶</abbr></a></h2>
    <p class="" style="">Many thanks to Dave Cridland for his feedback and advice.</p>
  <hr><a name="appendices"></a><h2>Appendices</h2><h3 id="appendix-docinfo">Appendix A: Document Information<a class="anchor-link" href="#appendix-docinfo"><abbr title="Link to this point in the document">¶</abbr></a></h3><dl class="compact"><dt>Series</dt><dd><a href="https://xmpp.org/extensions/">XEP</a></dd><dt>Number</dt><dd>0248</dd><dt>Publisher</dt><dd><a href="/xsf/">XMPP Standards Foundation</a></dd><dt>Status</dt><dd><a href="https://xmpp.org/extensions/xep-0001.html#states-Deferred">Deferred</a></dd><dt>Type</dt><dd><a href="https://xmpp.org/extensions/xep-0001.html#types-Standards%20Track">Standards Track</a></dd><dt>Version</dt><dd>0.3.0</dd><dt>Last Updated</dt><dd>2021-08-03</dd><dt>Approving Body</dt><dd><a href="https://xmpp.org/council/">XMPP Council</a></dd><dt>Dependencies</dt><dd>XMPP Core, XEP-0060</dd><dt>Supersedes</dt><dd>None</dd><dt>Superseded By</dt><dd>None</dd><dt>Short Name</dt><dd>NOT_YET_ASSIGNED</dd><dt>Source Control</dt><dd><a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0248.xml">HTML</a></dd></dl><p>
          This document in other formats:
          <a class="standardsButton" href="https://xmpp.org/extensions/xep-0248.xml">XML</a> 
          <a class="standardsButton" href="https://xmpp.org/extensions/xep-0248.pdf">PDF</a></p><h3 id="appendix-authorinfo">Appendix B: Author Information<a class="anchor-link" href="#appendix-authorinfo"><abbr title="Link to this point in the document">¶</abbr></a></h3><h5>Peter Saint-Andre</h5><dl class="compact"><dt>Email</dt><dd><a href="mailto:xsf@stpeter.im">xsf@stpeter.im</a></dd><dt>JabberID</dt><dd><a href="xmpp:peter@jabber.org">peter@jabber.org</a></dd><dt>URI</dt><dd><a href="http://stpeter.im/">http://stpeter.im/</a></dd></dl><h5>Ralph Meijer</h5><dl class="compact"><dt>Email</dt><dd><a href="mailto:ralphm@ik.nu">ralphm@ik.nu</a></dd><dt>JabberID</dt><dd><a href="xmpp:ralphm@ik.nu">ralphm@ik.nu</a></dd></dl><h5>Brian Cully</h5><dl class="compact"><dt>Email</dt><dd><a href="mailto:bjc@kublai.com">bjc@kublai.com</a></dd><dt>JabberID</dt><dd><a href="xmpp:bjc@kublai.com">bjc@kublai.com</a></dd></dl><h3 id="appendix-legal">Appendix C: Legal Notices<a class="anchor-link" href="#appendix-legal"><abbr title="Link to this point in the document">¶</abbr></a></h3><div class="indent"><h4>Copyright</h4><p>This XMPP Extension Protocol is copyright © 1999 – 2020 by the <a href="https://xmpp.org/">XMPP Standards Foundation</a> (XSF).</p><h4>Permissions</h4><p>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.</p><h4>Disclaimer of Warranty</h4><p class="box info">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</p><h4>Limitation of Liability</h4><p>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.</p><h4>IPR Conformance</h4><p>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="https://xmpp.org/about/xsf/ipr-policy">https://xmpp.org/about/xsf/ipr-policy</a>&gt; or obtained by writing to XMPP Standards Foundation, P.O. Box 787, Parker, CO 80134 USA).</p><h4>Visual Presentation</h4><p>The HTML representation (you are looking at) is maintained by the XSF. It is based on the <a href="http://yaml.de">YAML CSS Framework</a>, which is licensed under the terms of the <a href="https://creativecommons.org/licenses/by/2.0/">CC-BY-SA 2.0</a> license.</p></div><h3 id="appendix-xmpp">Appendix D: Relation to XMPP<a class="anchor-link" href="#appendix-xmpp"><abbr title="Link to this point in the document">¶</abbr></a></h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><h3 id="appendix-discuss">Appendix E: Discussion Venue<a class="anchor-link" href="#appendix-discuss"><abbr title="Link to this point in the document">¶</abbr></a></h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="https://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="https://xmpp.org/about/discuss.shtml">https://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><h3 id="appendix-conformance">Appendix F: Requirements Conformance<a class="anchor-link" href="#appendix-conformance"><abbr title="Link to this point in the document">¶</abbr></a></h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><h3 id="appendix-notes">Appendix G: Notes<a class="anchor-link" href="#appendix-notes"><abbr title="Link to this point in the document">¶</abbr></a></h3><div class="indent"><p><a name="nt-idm74">1</a>. XEP-0060: Publish-Subscribe &lt;<a href="https://xmpp.org/extensions/xep-0060.html">https://xmpp.org/extensions/xep-0060.html</a>&gt;.</p><p><a name="nt-idm119">2</a>. XEP-0030: Service Discovery &lt;<a href="https://xmpp.org/extensions/xep-0030.html">https://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-idm134">3</a>. XEP-0131: Stanza Headers and Internet Metadata &lt;<a href="https://xmpp.org/extensions/xep-0131.html">https://xmpp.org/extensions/xep-0131.html</a>&gt;.</p><p><a name="nt-idm151">4</a>. XEP-0004: Data Forms &lt;<a href="https://xmpp.org/extensions/xep-0004.html">https://xmpp.org/extensions/xep-0004.html</a>&gt;.</p><p><a name="nt-idm328">5</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p></div><h3 id="appendix-revs">Appendix H: Revision History<a class="anchor-link" href="#appendix-revs"><abbr title="Link to this point in the document">¶</abbr></a></h3><p>Note: Older versions of this specification might be available at <a href="https://xmpp.org/extensions/attic/">https://xmpp.org/extensions/attic/</a></p><ol class="revision-history"><li id="revision-history-v0.3.0"><div class="revision-head">Version 0.3.0 (2021-08-03)<a class="anchor-link" href="#revision-history-v0.3.0"><abbr title="Link to this point in the document">¶</abbr></a></div>Revert change from version 0.2.1 which changed meta-data to metadata in wire protocol. That was an unintended breaking change which has now been reverted.<div class="revision-author">rm</div></li><li id="revision-history-v0.2.1"><div class="revision-head">Version 0.2.1 (2018-11-03)<a class="anchor-link" href="#revision-history-v0.2.1"><abbr title="Link to this point in the document">¶</abbr></a></div>Fix a bunch of typos, batch-style.<div class="revision-author">pep</div></li><li id="revision-history-v0.2"><div class="revision-head">Version 0.2 (2010-09-28)<a class="anchor-link" href="#revision-history-v0.2"><abbr title="Link to this point in the document">¶</abbr></a></div>
        <p class="" style="">Completely reworked from initial version. To wit:</p>
        <ul class="" style="">
          <li class="" style="">Normalized layout</li>
          <li class="" style="">Added required sections</li>
          <li class="" style="">Renamed "multi-collection" disco feature to "multi-collections" for consistency with "collections" feature</li>
          <li class="" style="">Added associate request</li>
          <li class="" style="">Added dissociate request</li>
          <li class="" style="">Added ability to request items on a collection node</li>
          <li class="" style="">Removed "Node Relationship Models" section</li>
        </ul>
      <div class="revision-author">bjc</div></li><li id="revision-history-v0.1"><div class="revision-head">Version 0.1 (2008-08-11)<a class="anchor-link" href="#revision-history-v0.1"><abbr title="Link to this point in the document">¶</abbr></a></div><p class="" style="">Initial version, split from XEP-0060.</p><div class="revision-author">psa</div></li></ol><h3 id="appendix-biblatex">Appendix I: Bib(La)TeX Entry</h3><pre>
@report{saint-andre2008xep0248,
  title = {PubSub Collection Nodes},
  author = {Saint-Andre, Peter and Meijer, Ralph and Cully, Brian},
  type = {XEP},
  number = {0248},
  version = {0.3.0},
  institution = {XMPP Standards Foundation},
  url = {https://xmpp.org/extensions/xep-0248.html},
  date = {2008-08-11/2021-08-03},
}</pre><p>END</p></body></html>
