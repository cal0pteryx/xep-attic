<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0248: PubSub Collection Nodes</title><link rel="stylesheet" type="text/css" href="xmpp.css" /><link href="prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="PubSub Collection Nodes" /><meta name="DC.Creator" content="Peter Saint-Andre" /><meta name="DC.Creator" content="Ralph Meijer" /><meta name="DC.Creator" content="Brian Cully" /><meta name="DC.Description" content="This specification defines the nature and handling of collection nodes in the XMPP publish-subscribe extension." /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2018-11-03" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0248" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 &#x2013; 2018 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0248: PubSub Collection Nodes</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This specification defines the nature and handling of collection nodes in the XMPP publish-subscribe extension.</td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Peter Saint-Andre, Ralph Meijer, Brian Cully</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 – 2018 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Deferred</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>0.2.1</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2018-11-03</td></tr></table><hr /><p style="color:red">WARNING: This document has been automatically Deferred after 12 months of inactivity in its previous Experimental state. Implementation of the protocol described herein is not recommended for production systems. However, exploratory implementations are encouraged to resume the standards process.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#introduction">Introduction</a><br />2.  <a href="#scope">Scope</a><br />3.  <a href="#glossary">Glossary</a><br />4.  <a href="#preliminaries">Preliminaries</a><br />   
      4.1.  <a href="#collection-nodes">Collection Nodes</a><br />5.  <a href="#entity">Entity Use Cases</a><br />   
      5.1.  <a href="#disco-support">Discovering Support for Collection Nodes</a><br />   
      5.2.  <a href="#disco-nodes">Discover Nodes</a><br />      
      5.2.1.  <a href="#disco-nodes-request">Request</a><br />      
      5.2.2.  <a href="#disco-nodes-success">Success Case</a><br />   
      5.3.  <a href="#notifications">Notifications</a><br />      
      5.3.1.  <a href="#notify">Generating Notifications for Collections</a><br />        
      5.3.1.1.  <a href="#notify-items">Notifications about Items</a><br />        
      5.3.1.2.  <a href="#notify-items">Notifications about Nodes</a><br />      
      5.3.2.  <a href="#notify-associate-dissociate">Node Association and Dissociation</a><br />        
      5.3.2.1.  <a href="#notify-metadata">Including Node Meta-Data</a><br />6.  <a href="#subscriber">Subscriber Use Cases</a><br />   
      6.1.  <a href="#subscribe">Subscribe to a Collection Node</a><br />      
      6.1.1.  <a href="#subscribe-request">Request</a><br />      
      6.1.2.  <a href="#subscribe-success">Success Case</a><br />      
      6.1.3.  <a href="#subscribe-errors">Error Cases</a><br />   
      6.2.  <a href="#retrieve-items">Retrieving Items on Collection Nodes</a><br />      
      6.2.1.  <a href="#retrieve-request">Request</a><br />      
      6.2.2.  <a href="#retrieve-request">Success Case</a><br />      
      6.2.3.  <a href="#retrieve-errors">Error Cases</a><br />7.  <a href="#owner">Owner Use Cases</a><br />   
      7.1.  <a href="#createnode">Create a New Collection Node</a><br />      
      7.1.1.  <a href="#createnode-request">Request</a><br />      
      7.1.2.  <a href="#createnode-success">Success Case</a><br />      
      7.1.3.  <a href="#createnode-errors">Error Cases</a><br />        
      7.1.3.1.  <a href="#error-create-unsupported">Collection Nodes Unsupported</a><br />        
      7.1.3.2.  <a href="#error-create-notallowed">Collection Nodes Can't be Created</a><br />        
      7.1.3.3.  <a href="#error-create-forbidden">Entity is not Authorized</a><br />   
      7.2.  <a href="#configure-collection">Configuring a Collection Node</a><br />      
      7.2.1.  <a href="#configure-request">Request</a><br />      
      7.2.2.  <a href="#configure-success">Success Case</a><br />      
      7.2.3.  <a href="#configure-errors">Error Cases</a><br />        
      7.2.3.1.  <a href="#error-children-on-leaf">Configuring a Leaf Node with Children</a><br />        
      7.2.3.2.  <a href="#error-config-not-authorized">Entity is not Authorized</a><br />        
      7.2.3.3.  <a href="#error-max-children">Maximum Number of Children Exceeded</a><br />        
      7.2.3.4.  <a href="#error-node-type">Changing Node Types</a><br />        
      7.2.3.5.  <a href="#error-collection-cycle">Creating a Cycle in the Collection</a><br />   
      7.3.  <a href="#delete-node">Deleting a Collection Node</a><br />      
      7.3.1.  <a href="#delete-node-request">Request</a><br />      
      7.3.2.  <a href="#delete-node-success">Success Case</a><br />      
      7.3.3.  <a href="#delete-node-errors">Error Cases</a><br />        
      7.3.3.1.  <a href="#delete-root-node">Deleting the Root Node</a><br />   
      7.4.  <a href="#associate-node">Associating a Node to a Collection</a><br />      
      7.4.1.  <a href="#associate-request">Request</a><br />      
      7.4.2.  <a href="#associate-success">Success Case</a><br />      
      7.4.3.  <a href="#associate-errors">Error Cases</a><br />        
      7.4.3.1.  <a href="#error-assoc-auth">Entity is not Authorized</a><br />        
      7.4.3.2.  <a href="#error-assoc-too-many-nodes">Maximum Number of Children Exceeded</a><br />        
      7.4.3.3.  <a href="#error-assoc-cycle">Creating a Cycle in the Collection</a><br />   
      7.5.  <a href="#associate-node">Dissociating a Node from a Collection</a><br />      
      7.5.1.  <a href="#dissociate-request">Request</a><br />      
      7.5.2.  <a href="#dissociate-success">Success Case</a><br />      
      7.5.3.  <a href="#dissociate-errors">Error Cases</a><br />        
      7.5.3.1.  <a href="#error-dissoc-not-assoc">Node is not Associated</a><br />        
      7.5.3.2.  <a href="#error-dissoc-auth">Entity is not Authorized</a><br />8.  <a href="#impl-notes">Implementation Notes</a><br />   
      8.1.  <a href="#root">Root Node</a><br />   
      8.2.  <a href="#imple-delete">Handling Collection Node Deletion</a><br />   
      8.3.  <a href="#impl-config">Updating Node Configuration When Associating or Dissociating Nodes</a><br />9.  <a href="#security">Security Considerations</a><br />   
      9.1.  <a href="#security-access">Access Models</a><br />10.  <a href="#iana">IANA Considerations</a><br />11.  <a href="#registrar">XMPP Registrar Considerations</a><br />   
      11.1.  <a href="#registrar-features">Service Discovery Features</a><br />   
      11.2.  <a href="#registrar-formtypes">Field Standardization</a><br />   
      11.3.  <a href="#registrar-shim">SHIM Headers</a><br />12.  <a href="#schema">XML Schema</a><br />13.  <a href="#acknowledgements">Acknowledgements</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="introduction" id="introduction">Introduction</a></h2>
    <p class="" style=""><span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0060.html">Publish-Subscribe (XEP-0060)</a></span>  [<a href="#nt-idm69">1</a>] defines an XMPP protocol extension for generic publish-subscribe features. However, it only allows notifications from nodes to which an entity is directly subscribed. It is useful in some circumstances to describe a relationship between nodes so that a publish on one node may be delivered via another node. For instance, if an entity is interested in notifications from a set of nodes the entity would discover each node somehow and then subscribe to them. With collection nodes, the entity would subscribe only to the collection which links the desired nodes, simplifying the subscription process.</p>

    <p class="" style="">In addition to simplifying the subscriber's usage, collection nodes also allow the owner to describe almost any type of relationship between nodes. Using various access models on different nodes the owner can also create almost any desired authorization semantics on a set of leaf nodes.</p>

    <p class="em" style="">Note: Any use cases not described herein are described in <span class="ref">XEP-0060</span>. Also, this document does not show error flows related to the generic publish-subscribe use cases referenced herein, since they are exhaustively defined in <span class="ref">XEP-0060</span>. The reader is referred to <span class="ref">XEP-0060</span> for all relevant protocol details related to the XMPP publish-subscribe extension.</p>
  <h2>2.
       <a name="scope" id="scope">Scope</a></h2>
    <p class="" style="">This documents addresses the common requirements regarding configuration, publishing, subscribing, and notification semantics of collection nodes.</p>
  <h2>3.
       <a name="glossary" id="glossary">Glossary</a></h2>
    <p class="" style="">The following terms are used in this document to refer to collection node-specific features.</p>

    <p class="em" style="">Note: some of these terms are specified in greater detail within the body of this document.</p>

    <div class="indent"><dl>
      <di>
        <dt><strong>Collection Node</strong></dt>
        <dd>A type of node that contains other nodes but no published items (<span class="em">c.f.</span> Leaf Node).</dd>
      </di>

      <di>
        <dt><strong>Leaf Node</strong></dt>
        <dd>A type of node that contains published items but no other nodes (<span class="em">c.f.</span> Collection Node).</dd>
      </di>

      <di>
        <dt><strong>Node Graph</strong></dt>
        <dd>The network of nodes emitting from a given node which contains all its descendants.</dd>
      </di>

      <di>
        <dt><strong>Root Node</strong></dt>
        <dd>An anonymous collection node used as the <span class="em">de facto</span> beginning of a service's node graph.</dd>
      </di>

      <di>
        <dt><strong>Subscription Depth</strong></dt>
        <dd>How deep the collection node graph will be traversed when determining whether notifications will be sent. May be any integer, 0 or greater, or "all".</dd>
      </di>

      <di>
        <dt><strong>Subscription Type</strong></dt>
        <dd>The type of notification, either "nodes", "items", or "all" which the subscriber is interested in.</dd>
      </di>
    </dl></div>
  <h2>4.
       <a name="preliminaries" id="preliminaries">Preliminaries</a></h2>
    <div class="indent"><h3>4.1 <a name="collection-nodes" id="collection-nodes">Collection Nodes</a></h3>
      <p class="" style="">Collection nodes link nodes together to unify notifications from a set of collection or leaf nodes. An entity can subscribe to the collection and receive notifications of any associated leaf nodes.</p>

      <p class="" style="">A collection node can link with any other node in order to create a directed acyclic graph (DAG). Collection nodes MUST NOT be linked in such a way as to produce a cyclic graph (<span class="em">i.e.</span>, they cannot link to nodes that eventually link back to the initial node).</p>

      <p class="" style="">Collection nodes only contain other nodes and MUST NOT contain published items (therefore a collection MUST NOT support the "publish" feature or related features such as "persistent-items").</p>
    </div>
  <h2>5.
       <a name="entity" id="entity">Entity Use Cases</a></h2>
    <div class="indent"><h3>5.1 <a name="disco-support" id="disco-support">Discovering Support for Collection Nodes</a></h3>
      <p class="" style="">An entity might wish to discover if a service implements collection nodes; in order to do so, it sends a service discovery information ("disco#info") query to the component's JID using <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0030.html">Service Discovery (XEP-0030)</a></span>  [<a href="#nt-idm114">2</a>]. If a service supports collection nodes it MUST return a "pubsub#collections" feature. In addition, if the service supports associating a node with more than one collection it MUST return a feature of "pubsub#multi-collections".</p>

      <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Entity requests features from a service</p><div class="indent"><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'/&gt;
&lt;/iq&gt;
</pre></div>

      <p class="caption"><a name="example-2" id="example-2"></a>Example 2. Service responds with support for collections</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='info1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
    ...
    &lt;feature var='http://jabber.org/protocol/pubsub#collections'/&gt;
    &lt;feature var='http://jabber.org/protocol/pubsub#multi-collections'/&gt;
    ...
  &lt;/query&gt;
&lt;/iq&gt;
</pre></div>
    </div>

    <div class="indent"><h3>5.2 <a name="disco-nodes" id="disco-nodes">Discover Nodes</a></h3>
      <p class="" style="">The service discovery items ("disco#items") protocol enables an entity to query a service for a list of associated items, which, in the case of collection nodes would consist of the children associated with a given node.</p>

      <div class="indent"><h3>5.2.1 <a name="disco-nodes-request" id="disco-nodes-request">Request</a></h3>
        <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Entity requests child node discovery</p><div class="indent"><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='blogs'/&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>5.2.2 <a name="disco-nodes-success" id="disco-nodes-success">Success Case</a></h3>
        <p class="caption"><a name="example-4" id="example-4"></a>Example 4. Service responds with child nodes</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='disco1'&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#items'
         node='blogs'&gt;
    &lt;item node='Romeoance'
          name='Letters to my Beloved'
          jid='pubsub.shakespeare.lit'/&gt;
    &lt;item node='Julliennui'
          name='A Rose by Another Name'
          jid='pubsub.shakespeare.lit'/&gt;
  &lt;/query&gt;
&lt;/iq&gt;
</pre></div>
      </div>
    </div>

    <div class="indent"><h3>5.3 <a name="notifications" id="notifications">Notifications</a></h3>
      <div class="indent"><h3>5.3.1 <a name="notify" id="notify">Generating Notifications for Collections</a></h3>
        <p class="" style="">If a notification on a child node is created and then delivered via the collection then the notifications generated by the service MUST contain additional information. The 'node' attribute of the &lt;item/&gt; or &lt;node/&gt; element contained in the notification message MUST specify the node identifier of the node that generated the notification (not the collection) and the &lt;message/&gt; stanza MUST contain <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0131.html">Stanza Headers and Internet Metadata (XEP-0131)</a></span>  [<a href="#nt-idm129">3</a>] that specifies the node identifier of the collection.</p>

        <p class="em" style="">Note: The delivery options (such as "pubsub#deliver_payloads") are determined by the publishing leaf node, not by the collection node. If the owner of a collection node sets delivery options for a collection node, the service SHOULD ignore those options and apply the options set for the leaf node that publishes an item.</p>

        <div class="indent"><h3>5.3.1.1 <a name="notify-items" id="notify-items">Notifications about Items</a></h3>
          <p class="" style="">Item notifications are notifications about the contents of a leaf node, and are generated by a publish, retract, or purge request.</p>

          <p class="caption"><a name="example-5" id="example-5"></a>Example 5. Subscriber receives a publish notification from a collection</p><div class="indent"><pre class="prettyprint">
&lt;message to='francisco@denmark.lit' from='pubsub.shakespeare.lit'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;items node='princely_musings'&gt;
      &lt;item id='ae890ac52d0df67ed7cfdf51b644e901'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
  &lt;/event&gt;
  &lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
    &lt;header name='Collection'&gt;blogs&lt;/header&gt;
  &lt;/headers&gt;
&lt;/message&gt;
</pre></div>
        </div>

        <div class="indent"><h3>5.3.1.2 <a name="notify-items" id="notify-items">Notifications about Nodes</a></h3>
          <p class="" style="">Node notifications are notifications about nodes themselves, and are generated by a create, delete, or configure request.</p>

          <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Subscriber receives a creation notification from a collection</p><div class="indent"><pre class="prettyprint">
&lt;message to='francisco@denmark.lit' from='pubsub.shakespeare.lit'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;create node='princely_musings'/&gt;
  &lt;/event&gt;
  &lt;headers xmlns='http://jabber.org/protocol/shim'&gt;
    &lt;header name='Collection'&gt;blogs&lt;/header&gt;
  &lt;/headers&gt;
&lt;/message&gt;
</pre></div>
        </div>
    </div>

      <div class="indent"><h3>5.3.2 <a name="notify-associate-dissociate" id="notify-associate-dissociate">Node Association and Dissociation</a></h3>
        <p class="" style="">If a collection node is configured to send notification of node associations and disassociations, the service shall send an event that contains a &lt;collection/&gt; element whose 'node' attribute specifies the NodeID of the collection; this element in turn contains an &lt;associate/&gt; or &lt;dissociate/&gt; element whose 'node' attribute specifies the NodeID of node that has been associated with the collection.</p>

        <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Notification of node association</p><div class="indent"><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode1'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-node-id'&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></div>

        <p class="caption"><a name="example-8" id="example-8"></a>Example 8. Notification of node dissociation</p><div class="indent"><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode1'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;dissociate node='old-node-id'&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></div>

        <div class="indent"><h3>5.3.2.1 <a name="notify-metadata" id="notify-metadata">Including Node Meta-Data</a></h3>
          <p class="" style="">The notification event MAY also include the node metadata, formatted using the <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0004.html">Data Forms (XEP-0004)</a></span>  [<a href="#nt-idm146">4</a>] protocol.</p>

          <p class="caption"><a name="example-9" id="example-9"></a>Example 9. Notification of node association</p><div class="indent"><pre class="prettyprint">
&lt;message from='pubsub.shakespeare.lit'
         to='francisco@denmark.lit'
         id='newnode2'&gt;
  &lt;event xmlns='http://jabber.org/protocol/pubsub#event'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-node-id'&gt;
        &lt;x xmlns='jabber:x:data' type='result'&gt;
          &lt;field var='FORM_TYPE' type='hidden'&gt;
            &lt;value&gt;http://jabber.org/protocol/pubsub#metadata&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#creation_date'&gt;
            &lt;value&gt;2003-07-29T22:56Z&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#creator'&gt;
            &lt;value&gt;hamlet@denmark.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#description'&gt;
            &lt;value&gt;Atom feed for my blog.&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#language'&gt;
            &lt;value&gt;en&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#contact'&gt;
            &lt;value&gt;bard@shakespeare.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#owner'&gt;
            &lt;value&gt;hamlet@denmark.lit&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#title'&gt;
            &lt;value&gt;Princely Musings (Atom).&lt;/value&gt;
          &lt;/field&gt;
          &lt;field var='pubsub#type'
            &gt;&lt;value&gt;http://www.w3.org/2005/Atom&lt;/value&gt;
          &lt;/field&gt;
        &lt;/x&gt;
      &lt;/node&gt;
    &lt;/collection&gt;
  &lt;/event&gt;
&lt;/message&gt;
</pre></div>
        </div>
      </div>
    </div>
  <h2>6.
       <a name="subscriber" id="subscriber">Subscriber Use Cases</a></h2>
    <div class="indent"><h3>6.1 <a name="subscribe" id="subscribe">Subscribe to a Collection Node</a></h3>
      <p class="" style="">A service that implements collection nodes SHOULD allow entities to subscribe to collection nodes (subject to access models and local security policies).</p>
      <p class="" style="">In addition to the subscription configuration options already defined in <span class="ref">XEP-0060</span>, there are two subscription configuration options specific to collection nodes:</p>
      <ul class="" style="">
        <li class="" style="">
          <p class="" style=""><span class="strong">pubsub#subscription_type</span></p>
          <p class="" style="">This subscription option enables the subscriber to subscribe either to notifications about items or notifications about nodes.</p>

          <p class="" style="">If the subscription type is "items", the subscriber shall be notified whenever any node contained in the collection has an item published to it, retracted from it, or the node is purged, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">If the subscription type is "nodes", the subscriber shall be notified whenever a new node is added to the collection, removed from the collection, or the configuration of a node within the collection has changed, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">If the subscription type is "all", the subscriber shall be notified about both "items" and "nodes" types of events, as modified by the value of the "pubsub#subscription_depth" option.</p>

          <p class="" style="">The default value of this subscription option SHOULD be "nodes".</p>
        </li>

        <li class="" style="">
          <p class="" style=""><span class="strong">pubsub#subscription_depth</span></p>

          <p class="" style="">This subscription option enables the subscriber to specify how far to traverse the node graph when determining whether a notification will be sent. It may be any integer value, 0 or greater, or the value "all" which means that any node within the collection will generate a notification.</p>

          <p class="" style="">The default value of this subscription option SHOULD be "1".</p>
        </li>
      </ul>
      <p class="" style="">In order to subscribe to a collection node, an entity MUST send a subscription request to the node; the subscription request MAY include subscription options, but this is not strictly necessary (especially if the entity does not wish to override the default settings for the "pubsub#subscription_type" and "pubsub#subscription_depth" options).</p>

      <div class="indent"><h3>6.1.1 <a name="subscribe-request" id="subscribe-request">Request</a></h3>
        <p class="caption"><a name="example-10" id="example-10"></a>Example 10. Entity subscribes to a collection node (no configuration)</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'
               node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>

        <p class="" style="">The subscriber will now receive notification of new first-level nodes created within the "blogs" collection.</p>

        <p class="caption"><a name="example-11" id="example-11"></a>Example 11. Entity subscribes to a collection node (with configuration)</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'
               node='blogs'/&gt;
    &lt;options&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#subscribe_options&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#subscription_type'&gt;
          &lt;value&gt;items&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#subscription_depth'&gt;
          &lt;value&gt;all&lt;/value&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/options&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>6.1.2 <a name="subscribe-success" id="subscribe-success">Success Case</a></h3>
        <p class="" style="">If the service allows the subscription it MUST inform the requesting entity that it is now subscribed.</p>
        <p class="caption"><a name="example-12" id="example-12"></a>Example 12. Service responds with success</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscription node='blogs'
                  jid='francisco@denmark.lit'
                  subscription='subscribed'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>6.1.3 <a name="subscribe-errors" id="subscribe-errors">Error Cases</a></h3>
        <p class="" style="">A service MAY allow an entity to subscribe to a collection node in two ways, once with a subscription of type "nodes" (to receive notification of any new nodes added to the collection or the entire tree) and once with a subscription of type "items" (to receive all items published within the tree). However, a service SHOULD NOT allow an entity to subscribe twice to a collection node (once with a subscription depth of "1" and once with a subscription depth of "all") for the same subscription type, since two such subscriptions are unnecessary (a depth of "all" includes by definition a depth of "1"); in this case the service SHOULD return a &lt;conflict/&gt; error to the requesting entity.</p>

        <p class="caption"><a name="example-13" id="example-13"></a>Example 13. Service does not allow mulitple subscriptions to the same node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;error type='cancel'&gt;
    &lt;conflict xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>

        <p class="" style="">Depending on the nature of the node graph, a subscription type of "items" and depth of "all" may result in an extremely large number of notifications. Therefore, a service MAY disallow such a combination of subscription options, in which case it MUST return a &lt;not-allowed/&gt; error to the requesting entity.</p>

        <p class="caption"><a name="example-14" id="example-14"></a>Example 14. Service does not allow requested options</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='collsub1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
      </div>
    </div>

    <div class="indent"><h3>6.2 <a name="retrieve-items" id="retrieve-items">Retrieving Items on Collection Nodes</a></h3>
      <p class="" style="">When an entity requests items on a collection node the service SHOULD return the items on any leaf nodes associated with it subject to the access model of the collection node.</p>

      <div class="indent"><h3>6.2.1 <a name="retrieve-request" id="retrieve-request">Request</a></h3>
        <p class="caption"><a name="example-15" id="example-15"></a>Example 15. Subscriber requests all items on a collection</p><div class="indent"><pre class="prettyprint">
&lt;iq type='get'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='items1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>6.2.2 <a name="retrieve-request" id="retrieve-request">Success Case</a></h3>
        <p class="" style="">When a collection contains multiple nodes with items it MUST return multiple &lt;items/&gt; elements, one per node.</p>

        <p class="caption"><a name="example-16" id="example-16"></a>Example 16. Service returns items on leaf nodes</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='items1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;items node='Romeoance'&gt;
      &lt;item id='368866411b877c30064a5f62b917cffe'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
    &lt;items node='Julliennui'&gt;
      &lt;item id='3300659945416e274474e469a1f0154c'&gt;
        ...
      &lt;/item&gt;
    &lt;/items&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>6.2.3 <a name="retrieve-errors" id="retrieve-errors">Error Cases</a></h3>
        <p class="" style="">Depending on the nature of the node graph it may be expensive to allow item retrieval from a collection node. Therefore the service MAY disallow item retrieval via collection nodes, in which case it MUST return a &lt;feature-not-implemented/&gt; error to the requesting entity.</p>

        <p class="caption"><a name="example-17" id="example-17"></a>Example 17. Service cannot fulfil request</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='items1'&gt;
  &lt;error type='cancel'&gt;
    &lt;feature-not-implemented xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
      </div>
    </div>
  <h2>7.
       <a name="owner" id="owner">Owner Use Cases</a></h2>
    <div class="indent"><h3>7.1 <a name="createnode" id="createnode">Create a New Collection Node</a></h3>
      <p class="" style="">To create a new collection node, the requesting entity MUST include a Data Form containing a "pubsub#node_type" field whose &lt;value/&gt; element contains "collection". The default value for "pubsub#node_type" SHOULD be "leaf".</p>

      <div class="indent"><h3>7.1.1 <a name="createnode-request" id="createnode-request">Request</a></h3>
        <p class="caption"><a name="example-18" id="example-18"></a>Example 18. Entity requests a new collection node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='create3'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;create node='announcements'/&gt;
    &lt;configure&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#node_type'&gt;&lt;value&gt;collection&lt;/value&gt;&lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.1.2 <a name="createnode-success" id="createnode-success">Success Case</a></h3>
        <p class="caption"><a name="example-19" id="example-19"></a>Example 19. Service responds with success</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'/&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.1.3 <a name="createnode-errors" id="createnode-errors">Error Cases</a></h3>
        <p class="" style="">In addition to the errors already defined for leaf node creation, there are several reasons why the collection node creation request might fail:</p>

        <ol start="" class="" style="">
          <li class="" style="">The service does not support collection nodes.</li>
          <li class="" style="">The service does not support creation of collection nodes.</li>
          <li class="" style="">The requesting entity does not have sufficient privileges to create collection nodes.</li>
        </ol>

        <p class="" style="">These error cases are described more fully in the following sections.</p>

        <div class="indent"><h3>7.1.3.1 <a name="error-create-unsupported" id="error-create-unsupported">Collection Nodes Unsupported</a></h3>
          <p class="" style="">If the service does not support collection nodes, it MUST respond with a &lt;feature-not-implemented/&gt; error, specifying a pubsub-specific error condition of &lt;unsupported/&gt; and a feature of "collections".</p>

          <p class="caption"><a name="example-20" id="example-20"></a>Example 20. Service does not support collection nodes</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'&gt;
  &lt;error type='cancel'&gt;
    &lt;feature-not-implemented xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;unsupported xmlns='http://jabber.org/protocol/pubsub#errors'
                 feature='collections'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.1.3.2 <a name="error-create-notallowed" id="error-create-notallowed">Collection Nodes Can't be Created</a></h3>
          <p class="" style="">If the service supports collection nodes but does not allow new collection nodes to be created, it MUST respond with a &lt;not-allowed/&gt; error.</p>

          <p class="caption"><a name="example-21" id="example-21"></a>Example 21. Service does not allow creation of collection nodes</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='hamlet@denmark.lit/elsinore'
    to='pubsub.shakespeare.lit'
    id='create3'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.1.3.3 <a name="error-create-forbidden" id="error-create-forbidden">Entity is not Authorized</a></h3>
          <p class="" style="">If the requesting entity has insufficient privileges to create new collections, the service MUST respond with a &lt;forbidden/&gt; error.</p>

          <p class="caption"><a name="example-22" id="example-22"></a>Example 22. Requesting entity has insufficient privileges to create collection nodes</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='create3'&gt;
  &lt;error type='auth'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>
      </div>
    </div>

    <div class="indent"><h3>7.2 <a name="configure-collection" id="configure-collection">Configuring a Collection Node</a></h3>
      <div class="indent"><h3>7.2.1 <a name="configure-request" id="configure-request">Request</a></h3>
        <p class="" style="">In addition to the node configuration options specified in <span class="ref">XEP-0060</span>, there are three additional node configuration options that a service which supports collection nodes MUST supply.</p>

        <ul class="" style="">
          <li class="" style=""><span class="strong">pubsub#node_type</span>
          <p class="" style="">Whether this is a "leaf" or "collection" node.</p></li>
          <li class="" style=""><span class="strong">pubsub#collection</span>
          <p class="" style="">The parents of this node.</p></li>
          <li class="" style=""><span class="strong">pubsub#children</span>
          <p class="" style="">The children of this node.</p></li>
        </ul>

        <p class="" style="">To associate the root node to the collection the &lt;value/&gt; element MUST be empty.</p>

      <p class="" style="">A service MAY offer some node configuration options that are specific to collection nodes and SHOULD NOT be provided in configuration forms related to leaf nodes. The following are RECOMMENDED:</p>

      <ul class="" style="">
        <li class="" style=""><span class="strong">pubsub#children_association_policy</span>
        <p class="" style="">The policy regarding who may associate child nodes with the collection (values: all, owner, whitelist).</p></li>
        <li class="" style=""><span class="strong">pubsub#children_association_whitelist</span>
        <p class="" style="">The whitelist of entities that may associate child nodes with the collection.</p></li>
        <li class="" style=""><span class="strong">pubsub#children_max</span>
        <p class="" style="">The maximum number of child nodes that may be associated with a collection.</p></li>
      </ul>


        <p class="caption"><a name="example-23" id="example-23"></a>Example 23. Entity configures a collection node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='config1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;configure node='blogs'&gt;
      &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
          &lt;value&gt;http://jabber.org/protocol/pubsub#node_config&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#node_type'&gt;
          &lt;value&gt;collection&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#children'&gt;
          &lt;value&gt;Romeoance&lt;/value&gt;
          &lt;value&gt;Julliennui&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='pubsub#collection'&gt;
          &lt;value/&gt;
        &lt;/field&gt;
      &lt;/x&gt;
    &lt;/configure&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.2.2 <a name="configure-success" id="configure-success">Success Case</a></h3>
        <p class="caption"><a name="example-24" id="example-24"></a>Example 24. Service successfully updates configuration</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'/&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.2.3 <a name="configure-errors" id="configure-errors">Error Cases</a></h3>
        <div class="indent"><h3>7.2.3.1 <a name="error-children-on-leaf" id="error-children-on-leaf">Configuring a Leaf Node with Children</a></h3>
          <p class="" style="">Leaf nodes only contain published items and MUST NOT have any children. If an entity attempts to add children to a leaf node (either via "pubsub#children" on the leaf node or "pubsub#collection" on another node) the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <p class="caption"><a name="example-25" id="example-25"></a>Example 25. Attempt to add a leaf node as the parent of another node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.2.3.2 <a name="error-config-not-authorized" id="error-config-not-authorized">Entity is not Authorized</a></h3>
          <p class="" style="">If the requesting entity is not authorized to add the node to a collection then the service MUST return a &lt;forbidden/&gt; error.</p>

          <p class="caption"><a name="example-26" id="example-26"></a>Example 26. Entity is not authorized to add node to a collection</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.2.3.3 <a name="error-max-children" id="error-max-children">Maximum Number of Children Exceeded</a></h3>
          <p class="" style="">If the configuration would exceed the maximum number of children allowed on a node, either because the node's "pubsub#children" exceeds its own "pubsub#children_max" value or because adding this node to a parent via "pubsub#collection" would exceed the parent's "pubsub#children_max" value, the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;max-nodes-exceeded/&gt;.</p>

          <p class="caption"><a name="example-27" id="example-27"></a>Example 27. Node would contain too many children</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;max-nodes-exceeded xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.2.3.4 <a name="error-node-type" id="error-node-type">Changing Node Types</a></h3>
          <p class="" style="">The service MUST NOT allow the node type to be changed. If it is attempted the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;</p>

          <p class="caption"><a name="example-28" id="example-28"></a>Example 28. Attempt to change node type</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.2.3.5 <a name="error-collection-cycle" id="error-collection-cycle">Creating a Cycle in the Collection</a></h3>
          <p class="" style="">The service MUST NOT allow a cycle to be created in the node graph (<span class="em">e.g.</span>, node A to B to C to A). If an entity attempts to submit a configuration that would create a cycle the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <p class="caption"><a name="example-29" id="example-29"></a>Example 29. Cycle created in node graph</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='config1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>
      </div>
    </div>

    <div class="indent"><h3>7.3 <a name="delete-node" id="delete-node">Deleting a Collection Node</a></h3>
      <div class="indent"><h3>7.3.1 <a name="delete-node-request" id="delete-node-request">Request</a></h3>
        <p class="" style="">If a service supports collection node creation it MUST support collection node deletion.</p>

        <p class="caption"><a name="example-30" id="example-30"></a>Example 30. Owner attempts to delete a collection node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='delete1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;delete node='blogs'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.3.2 <a name="delete-node-success" id="delete-node-success">Success Case</a></h3>
        <p class="" style="">If no error occurs, the service MUST inform the owner of success.</p>

        <p class="caption"><a name="example-31" id="example-31"></a>Example 31. Collection node was deleted</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='delete1'/&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.3.3 <a name="delete-node-errors" id="delete-node-errors">Error Cases</a></h3>
        <div class="indent"><h3>7.3.3.1 <a name="delete-root-node" id="delete-root-node">Deleting the Root Node</a></h3>
          <p class="" style="">If the requesting entity attempts to delete the root node, the service MUST return a &lt;not-allowed/&gt; error.</p>

          <p class="caption"><a name="example-32" id="example-32"></a>Example 32. Node is the root</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='delete1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>
      </div>
    </div>

    <div class="indent"><h3>7.4 <a name="associate-node" id="associate-node">Associating a Node to a Collection</a></h3>
      <div class="indent"><h3>7.4.1 <a name="associate-request" id="associate-request">Request</a></h3>
      <p class="" style="">A service MAY allow collection nodes to have children associated with them without changing the rest of the configuration. If the service allows this an entity can send and &lt;associate/&gt; element with a 'node' attribute that contains the child node within a &lt;collection/&gt; element that posesses a 'node' attribute containing the parent node to the service.</p>

        <p class="caption"><a name="example-33" id="example-33"></a>Example 33. Entity requests node association</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='assoc1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;associate node='new-child-node'/&gt;
    &lt;/collection&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.4.2 <a name="associate-success" id="associate-success">Success Case</a></h3>
        <p class="" style="">If the service allows the node association then it MUST confirm the association with an empty result.</p>

        <p class="caption"><a name="example-34" id="example-34"></a>Example 34. Service associates the node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='assoc1'/&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.4.3 <a name="associate-errors" id="associate-errors">Error Cases</a></h3>
        <div class="indent"><h3>7.4.3.1 <a name="error-assoc-auth" id="error-assoc-auth">Entity is not Authorized</a></h3>
          <p class="caption"><a name="example-35" id="example-35"></a>Example 35. Entity is not authorized to associate the node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.4.3.2 <a name="error-assoc-too-many-nodes" id="error-assoc-too-many-nodes">Maximum Number of Children Exceeded</a></h3>
          <p class="" style="">If the configuration would exceed the maximum number of children allowed on a node, either because the node's "pubsub#children" exceeds its own "pubsub#children_max" value or because adding this node to a parent via "pubsub#collection" would exceed the parent's "pubsub#children_max" value, the service MUST return a &lt;not-allowed/&gt; error with a pubsub-specific error condition of &lt;max-nodes-exceeded/&gt;.</p>

          <p class="caption"><a name="example-36" id="example-36"></a>Example 36. Node would contain too many children</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;max-nodes-exceeded xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.4.3.3 <a name="error-assoc-cycle" id="error-assoc-cycle">Creating a Cycle in the Collection</a></h3>
          <p class="" style="">The service MUST NOT allow a cycle to be created in the node graph (<span class="em">e.g</span>., node A to B to C to A). If an entity attempts to submit a configuration that would create a cycle the service MUST return a &lt;not-allowed/&gt; error, specifying a pubsub-specific error condition of &lt;invalid-options/&gt;.</p>

          <p class="caption"><a name="example-37" id="example-37"></a>Example 37. Cycle created in node graph</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='assoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;not-allowed xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
    &lt;invalid-options xmlns='http://jabber.org/protocol/pubsub#errors'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>
      </div>
    </div>

    <div class="indent"><h3>7.5 <a name="associate-node" id="associate-node">Dissociating a Node from a Collection</a></h3>
      <div class="indent"><h3>7.5.1 <a name="dissociate-request" id="dissociate-request">Request</a></h3>
      <p class="" style="">A service MAY allow collection nodes to have children dissociated from them without changing the rest of the configuration. If the service allows this an entity can send and &lt;dissociate/&gt; element with a 'node' attribute that contains the child node within a &lt;collection/&gt; element that posesses a 'node' attribute containing the parent node to the service.</p>

        <p class="caption"><a name="example-38" id="example-38"></a>Example 38. Entity requests node dissociation</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='dissoc1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub#owner'&gt;
    &lt;collection node='some-collection'&gt;
      &lt;dissociate node='old-child-node'/&gt;
    &lt;/collection&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.5.2 <a name="dissociate-success" id="dissociate-success">Success Case</a></h3>
        <p class="" style="">If the service allows the node dissociation then it MUST confirm the association with an empty result.</p>

        <p class="caption"><a name="example-39" id="example-39"></a>Example 39. Service dissociates the node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='dissoc1'/&gt;
</pre></div>
      </div>

      <div class="indent"><h3>7.5.3 <a name="dissociate-errors" id="dissociate-errors">Error Cases</a></h3>
        <div class="indent"><h3>7.5.3.1 <a name="error-dissoc-not-assoc" id="error-dissoc-not-assoc">Node is not Associated</a></h3>
          <p class="" style="">If a dissociation is requested between two nodes that are not already associated then the service MUST return a &lt;bad-request/&gt; error.</p>

          <p class="caption"><a name="example-40" id="example-40"></a>Example 40. Node is not associated</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit'
    id='dissoc1'&gt;
  &lt;error type='modify'&gt;
    &lt;bad-request xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>

        <div class="indent"><h3>7.5.3.2 <a name="error-dissoc-auth" id="error-dissoc-auth">Entity is not Authorized</a></h3>
          <p class="caption"><a name="example-41" id="example-41"></a>Example 41. Entity is not authorized to dissociate the node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='error'
    from='pubsub.shakespeare.lit'
    to='francisco@denmark.lit/barracks'
    id='dissoc1'&gt;
  &lt;error type='cancel'&gt;
    &lt;forbidden xmlns='urn:ietf:params:xml:ns:xmpp-stanzas'/&gt;
  &lt;/error&gt;
&lt;/iq&gt;
</pre></div>
        </div>
      </div>
    </div>
  <h2>8.
       <a name="impl-notes" id="impl-notes">Implementation Notes</a></h2>
    <div class="indent"><h3>8.1 <a name="root" id="root">Root Node</a></h3>
      <p class="" style="">To provide a starting point for service discovery a service SHOULD support a root node. A root node represents the node belonging to a given service and MUST be identified by the lack of a node identifier (<span class="em">i.e.</span>, the address of the pubsub service itself, such as "pubsub.shakespeare.lit"). Because the root node is owned by the service itself an entity SHOULD NOT be allowed create, delete, or configure the root node.</p>

      <p class="" style="">If a node is created or configured without any parents specified, a service MAY automatically associate otherwise orphaned nodes directly to the root node. If a service automatically associates a node with the root it MUST reflect that in the node configuration data form.</p>

      <p class="caption"><a name="example-42" id="example-42"></a>Example 42. Entity subscribes to the root node</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='francisco@denmark.lit/barracks'
    to='pubsub.shakespeare.lit'
    id='root1'&gt;
  &lt;pubsub xmlns='http://jabber.org/protocol/pubsub'&gt;
    &lt;subscribe jid='francisco@denmark.lit'/&gt;
  &lt;/pubsub&gt;
&lt;/iq&gt;
</pre></div>
    </div>

    <div class="indent"><h3>8.2 <a name="imple-delete" id="imple-delete">Handling Collection Node Deletion</a></h3>
      <p class="" style="">Deletion of collection nodes can have a number of side effects due to implementation. Depending on the nature of the collection any of the following MAY happen when a collection node is deleted:</p>

      <ul class="" style="">
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are orphaned; meaning that they will have no parent node, but continue to exist.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are re-assigned as children of the root node.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have no other parents the child nodes are also deleted.</li>
        <li class="" style="">When the collection node is deleted and the child nodes have at least one other node the child nodes MUST remain associated with remaining parent nodes.</li>
      </ul>
    </div>

    <div class="indent"><h3>8.3 <a name="impl-config" id="impl-config">Updating Node Configuration When Associating or Dissociating Nodes</a></h3>
      <p class="" style="">Node configuration MUST always reflect the current state of the node graph. Because node configuration contains both a pointer to its parents as well as its children an update to a primary node's "pubsub#collection" value will change the value of the secondary node's "pubsub#children" value, and vice-versa. A service MAY send a notification of the configuration change on the secondary node to subscribers if "pubsub#notify_config" is enabled on the secondary node.</p>
    </div>
  <h2>9.
       <a name="security" id="security">Security Considerations</a></h2>
    <div class="indent"><h3>9.1 <a name="security-access" id="security-access">Access Models</a></h3>
      <p class="" style="">Collection nodes can be used to associate almost any node within the service, but only the access model of the collection node itself is used to determine what an entity is allowed to see. Therefore care should be taken that nodes are not linked in such a way as to leak private data (e.g., from a "closed" leaf node through an "open" collection) unless that behavior is specifically desired.</p>
    </div>
  <h2>10.
       <a name="iana" id="iana">IANA Considerations</a></h2>
    <p class="" style="">This document requires no interaction with the <span class="ref" style=""><a href="http://www.iana.org/">Internet Assigned Numbers Authority (IANA)</a></span>  [<a href="#nt-idm323">5</a>].</p>
  <h2>11.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
    <p class="em" style="">Note: These options are in addition to the standard options described in <span class="ref">XEP-0060</span> and related XEPs.</p>

    <div class="indent"><h3>11.1 <a name="registrar-features" id="registrar-features">Service Discovery Features</a></h3>
      <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;var&gt;
  &lt;name&gt;pubsub#collections&lt;/name&gt;
  &lt;desc&gt;Support for collection nodes&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/var&gt;
&lt;var&gt;
  &lt;name&gt;pubsub#multi-collections&lt;/name&gt;
  &lt;desc&gt;Support for multiple collections on a node&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/var&gt;
</pre></div>
    </div>

    <div class="indent"><h3>11.2 <a name="registrar-formtypes" id="registrar-formtypes">Field Standardization</a></h3>
      <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;form_type&gt;
  &lt;name&gt;http://jabber.org/protocol/pubsub#subscribe_options&lt;/name&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
  &lt;desc&gt;Options for collection node subscription&lt;/desc&gt;
  &lt;field
      var='pubsub#subscription_depth'
      type='text-single'&gt;
      label='How far to traverse the node graph for notifications'/&gt;
  &lt;field
      var='pubsub#subscription_type'
      type='list-single'&gt;
    &lt;option label='Receive notification of items only'&gt;
      items
    &lt;/option&gt;
    &lt;option label='Receive notification of nodes only'&gt;
      nodes
    &lt;/option&gt;
    &lt;option label='Receive notification of items and nodes'&gt;
      all
    &lt;/option&gt;
  &lt;/field&gt;
&lt;/form_type&gt;
&lt;form_type&gt;
  &lt;name&gt;http://jabber.org/protocol/pubsub#node_config&lt;/name&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
  &lt;desc&gt;Options for collection node configuration&lt;/desc&gt;
  &lt;field
      var='pubsub#node_type'
      type='list-single'&gt;
    &lt;option label='The node contains items'&gt;
      leaf
    &lt;/option&gt;
    &lt;option label='The node contains other nodes'&gt;
      collection
    &lt;/option&gt;
  &lt;/field&gt;
  &lt;field
      var='pubsub#collection'
      type='text-multi'
      label='The collections of which this node is a child'/&gt;
  &lt;field
      var='pubsub#children'
      type='text-multi'
      label='The nodes of which this node is a parent'/&gt;
  &lt;field
      var='pubsub#children_association_policy'
      type='list-single'&gt;
    &lt;option label='Only the owners of this node may associate other nodes to this collection'&gt;
      owners
    &lt;/option&gt;
    &lt;option label='Only those on the children association whitelist may associate other nodes to this collection'&gt;
      whitelist
    &lt;/option&gt;
    &lt;option label='Anyone may associate nodes with this collection'&gt;
      all
    &lt;/option&gt;
  &lt;/field&gt;
  &lt;field
      var='pubsub#children_association_whitelist'
      type='jid-multi'
      label='JIDs who can associate nodes to this collection'/&gt;
  &lt;field
      var='pubsub#children_max'
      type='text-single'
      label='The maximum number of children for this collection'/&gt;
&lt;/form_type&gt;
</pre></div>
    </div>

    <div class="indent"><h3>11.3 <a name="registrar-shim" id="registrar-shim">SHIM Headers</a></h3>
      <p class="caption"></p><div class="indent"><pre class="prettyprint">
&lt;header&gt;
  &lt;name&gt;Collection&lt;/name&gt;
  &lt;desc&gt;The node of subscription that sent a notification&lt;/desc&gt;
  &lt;doc&gt;XEP-0248&lt;/doc&gt;
&lt;/header&gt;
</pre></div>
    </div>
  <h2>12.
       <a name="schema" id="schema">XML Schema</a></h2>
    <p class="" style="">REQUIRED.</p>
  <h2>13.
       <a name="acknowledgements" id="acknowledgements">Acknowledgements</a></h2>
    <p class="" style="">Many thanks to Dave Cridland for his feedback and advice.</p>
  <hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0248<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status:
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Deferred">Deferred</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.2.1<br />
            Last Updated: 2018-11-03<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XEP-0060<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: NOT_YET_ASSIGNED<br />
              Source Control:
                <a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0248.xml">HTML</a><br />
            This document in other formats:
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0248.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0248.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Peter Saint-Andre</h3><p class="indent">
        Email:
        <a href="mailto:xsf@stpeter.im">xsf@stpeter.im</a><br />
        JabberID:
        <a href="xmpp:peter@jabber.org">peter@jabber.org</a><br />
        URI:
        <a href="http://stpeter.im/">http://stpeter.im/</a><br /></p><h3>Ralph Meijer</h3><p class="indent">
        Email:
        <a href="mailto:ralphm@ik.nu">ralphm@ik.nu</a><br />
        JabberID:
        <a href="xmpp:ralphm@ik.nu">ralphm@ik.nu</a><br /></p><h3>Brian Cully</h3><p class="indent">
        Email:
        <a href="mailto:bjc@kublai.com">bjc@kublai.com</a><br />
        JabberID:
        <a href="xmpp:bjc@kublai.com">bjc@kublai.com</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 – 2018 by the <a href="https://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="https://xmpp.org/about/xsf/ipr-policy">https://xmpp.org/about/xsf/ipr-policy</a>&gt; or obtained by writing to XMPP Standards Foundation, P.O. Box 787, Parker, CO 80134 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-idm69" id="nt-idm69">1</a>. XEP-0060: Publish-Subscribe &lt;<a href="https://xmpp.org/extensions/xep-0060.html">https://xmpp.org/extensions/xep-0060.html</a>&gt;.</p><p><a name="nt-idm114" id="nt-idm114">2</a>. XEP-0030: Service Discovery &lt;<a href="https://xmpp.org/extensions/xep-0030.html">https://xmpp.org/extensions/xep-0030.html</a>&gt;.</p><p><a name="nt-idm129" id="nt-idm129">3</a>. XEP-0131: Stanza Headers and Internet Metadata &lt;<a href="https://xmpp.org/extensions/xep-0131.html">https://xmpp.org/extensions/xep-0131.html</a>&gt;.</p><p><a name="nt-idm146" id="nt-idm146">4</a>. XEP-0004: Data Forms &lt;<a href="https://xmpp.org/extensions/xep-0004.html">https://xmpp.org/extensions/xep-0004.html</a>&gt;.</p><p><a name="nt-idm323" id="nt-idm323">5</a>. The Internet Assigned Numbers Authority (IANA) is the central coordinator for the assignment of unique parameter values for Internet protocols, such as port numbers and URI schemes. For further information, see &lt;<a href="http://www.iana.org/">http://www.iana.org/</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 0.2.1 (2018-11-03)</h4><div class="indent">Fix a bunch of typos, batch-style. (pep)
    </div><h4>Version 0.2 (2010-09-28)</h4><div class="indent">
        <p class="" style="">Completely reworked from initial version. To wit:</p>
        <ul class="" style="">
          <li class="" style="">Normalized layout</li>
          <li class="" style="">Added required sections</li>
          <li class="" style="">Renamed "multi-collection" disco feature to "multi-collections" for consistency with "collections" feature</li>
          <li class="" style="">Added associate request</li>
          <li class="" style="">Added dissociate request</li>
          <li class="" style="">Added ability to request items on a collection node</li>
          <li class="" style="">Removed "Node Relationship Models" section</li>
        </ul>
       (bjc)
    </div><h4>Version 0.1 (2008-08-11)</h4><div class="indent"><p class="" style="">Initial version, split from XEP-0060.</p> (psa)
    </div></div><hr /><p>END</p></body></html>
