<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>XEP-0404: Mediated Information eXchange (MIX): JID Hidden Channels.</title><link rel="stylesheet" type="text/css" href="xmpp.css" /><link href="prettify.css" type="text/css" rel="stylesheet" /><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" /><script type="text/javascript" src="prettify.js"></script><meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=2.0" /><meta name="DC.Title" content="Mediated Information eXchange (MIX): JID Hidden Channels." /><meta name="DC.Creator" content="Kevin Smith" /><meta name="DC.Creator" content="Steve Kille" /><meta name="DC.Description" content="This document defines an extension to Mediated Information eXchange (MIX) specified in XEP-0369.  This specification extends MIX to provide a number of privacy control options and in particular JID Hidden Channels. " /><meta name="DC.Publisher" content="XMPP Standards Foundation" /><meta name="DC.Contributor" content="XMPP Extensions Editor" /><meta name="DC.Date" content="2018-05-21" /><meta name="DC.Type" content="XMPP Extension Protocol" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="XEP-0404" /><meta name="DC.Language" content="en" /><meta name="DC.Rights" content="This XMPP Extension Protocol is copyright &#xA9; 1999 &#x2013; 2018 by the XMPP Standards Foundation (XSF)." /></head><body onload="prettyPrint()"><h1>XEP-0404: Mediated Information eXchange (MIX): JID Hidden Channels.</h1><table><tr valign="top"><td><strong>Abstract:</strong></td><td>This document defines an extension to Mediated Information eXchange (MIX) specified in XEP-0369.  This specification extends MIX to provide a number of privacy control options and in particular JID Hidden Channels. </td></tr><tr valign="top"><td><strong>Authors:</strong></td><td>Kevin Smith, Steve Kille</td></tr><tr valign="top"><td><strong>Copyright:</strong></td><td>© 1999 – 2017 XMPP Standards Foundation. <a href="#appendix-legal">SEE LEGAL NOTICES</a>.</td></tr><tr valign="top"><td><strong>Status:</strong></td><td>Experimental</td></tr><tr valign="top"><td><strong>Type:</strong></td><td>Standards Track</td></tr><tr valign="top"><td><strong>Version:</strong></td><td>0.1.0</td></tr><tr valign="top"><td><strong>Last Updated:</strong></td><td>2018-05-21</td></tr></table><hr /><p style="color:red">WARNING: This Standards-Track document is Experimental. Publication as an XMPP Extension Protocol does not imply approval of this proposal by the XMPP Standards Foundation. Implementation of the protocol described herein is encouraged in exploratory implementations, but production systems are advised to carefully consider whether it is appropriate to deploy implementations of this protocol before it advances to a status of Draft.</p><hr /><h2>Table of Contents</h2><div class="indent"><p><br />1.  <a href="#intro">Introduction</a><br />2.  <a href="#concepts">Concepts</a><br />   
      2.1.  <a href="#concepts-pm">Private Messages</a><br />   
      2.2.  <a href="#proxy-jid-services">JID Visibility Services</a><br />   
      2.3.  <a href="#proxy-jid-architecture">JID Visibility Architecture</a><br />   
      2.4.  <a href="#proxy-jid-resource">Resource Hiding</a><br />   
      2.5.  <a href="#concepts-nodes">JID Map Node</a><br />3.  <a href="#usecases">Use Cases</a><br />   
      3.1.  <a href="#usecase-visibilty-pref">User Preferences and Additional Information</a><br />   
      3.2.  <a href="#usecase-user-private-messages">Sending Private Messages</a><br />   
      3.3.  <a href="#usecase-vcard">Requesting vCard</a><br />4.  <a href="#i18n">Internationalization Considerations</a><br />5.  <a href="#security">Security Considerations</a><br />6.  <a href="#iana">IANA Considerations</a><br />7.  <a href="#registrar">XMPP Registrar Considerations</a><br />8.  <a href="#schema">XML Schema</a><br />9.  <a href="#ack">Acknowledgements</a></p><p><a href="#appendices">Appendices</a><br />    <a href="#appendix-docinfo">A: Document Information</a><br />    <a href="#appendix-authorinfo">B: Author Information</a><br />    <a href="#appendix-legal">C: Legal Notices</a><br />    <a href="#appendix-xmpp">D: Relation to XMPP</a><br />    <a href="#appendix-discuss">E: Discussion Venue</a><br />    <a href="#appendix-conformance">F: Requirements Conformance</a><br />    <a href="#appendix-notes">G: Notes</a><br />    <a href="#appendix-revs">H: Revision History</a></p></div><hr /><h2>1.
       <a name="intro" id="intro">Introduction</a></h2>
  <p class="" style="">The Mediated Information eXchange (MIX) protocol framework and core capabilities are specified in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>] (MIX-CORE).    This specification provides mechanisms to hide participant JIDs from other participants.   This is needed to address privacy concerns and to prevent JID harvesting. It also addresses privacy issues, and gives participants options to control sharing of information.
   </p>

<h2>2.
       <a name="concepts" id="concepts">Concepts</a></h2>






  <div class="indent"><h3>2.1 <a name="concepts-pm" id="concepts-pm">Private Messages</a></h3>
    <p class="" style="">
      <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>] exposes participant JIDs to other participants, and so messages can always be sent directly. When JIDs are hidden this is no longer possible.
      Private messages MAY be sent to channel participants if allowed by channel policy. Private messages are
 addressed to the user's bare proxy JID determined from the participants node, and routed by the MIX to the user's bare real JID, where standard distribution rules will apply.
    </p>

  </div>

    <div class="indent"><h3>2.2 <a name="proxy-jid-services" id="proxy-jid-services">JID Visibility Services</a></h3>


    <p class="" style="">
      MIX channels have three modes controlling JID visibility, defined to prevent JID harvesting:
    </p>
    <div class="indent"><p class="caption"><a name="table-1" id="table-1"></a>Table 1: JID Visibility Modes</p><table border="1" cellpadding="3" cellspacing="0">
      <tr class="body"><th colspan="" rowspan="">Mode</th><th colspan="" rowspan="">Description</th></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'JID Visible'</td><td align="" colspan="" rowspan="">In these channels all participant JIDs are visible to all channel participants.</td></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'JID Maybe Visible'</td><td align="" colspan="" rowspan="">In these channels, participant JIDs are visible to all channel participants when participant preference allows.</td></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'JID Hidden'</td><td align="" colspan="" rowspan="">In these channels, no participant JIDs are visible to channel participants, but they are visible to channel administrators.</td></tr>
    </table></div>
    <p class="" style="">
      A channel participant MAY specify a preference for JID visibility for the channel, with one of the following values:
    </p>
    <div class="indent"><p class="caption"><a name="table-2" id="table-2"></a>Table 2: JID Visibility Preference Options</p><table border="1" cellpadding="3" cellspacing="0">
      <tr class="body"><th colspan="" rowspan="">Preference</th><th colspan="" rowspan="">Description</th></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'Prefer Visible'</td><td align="" colspan="" rowspan="">The users JID will be visible if the channel is  JID Visible or  JID Maybe Visible channels and hidden if the channel is JID Hidden.  </td></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'Prefer Hidden'</td><td align="" colspan="" rowspan="">The user's JID will be hidden if the channel is  JID Maybe Visible and shown if the channel is  JID Visible .</td></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'Enforce Hidden'</td><td align="" colspan="" rowspan="">The user's JID will never be shown and the user will be removed from channel if channel mode is changed to JID Visible.</td></tr>
      <tr class="body"><td align="" colspan="" rowspan="">'Enforce Visible'</td><td align="" colspan="" rowspan="">The users JID will always be shown and the user will be removed from channel if mode is changed to 'JID Hidden'.</td></tr>
    </table></div>
    <p class="" style="">
      The default value is 'Prefer Hidden'.
    </p>
    </div>

    <div class="indent"><h3>2.3 <a name="proxy-jid-architecture" id="proxy-jid-architecture">JID Visibility Architecture</a></h3>
      <p class="" style="">
         MUC hides real JIDs by using Nicks to identify room occupants.  This has problems with Nick changing and with multiple active clients for the same user.    MIX identifies channel participants by a proxy JID, which is an anonymized stable JID format identifier for each participant. In <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>], the participants node provides a mapping from the proxy JID to the real JID.    To hide JIDs, this specification makes two key changes

      </p>

      <ol start="" class="" style="">
        <li class="" style="">The requirement to include real JID in the participants list is relaxed for channels that are not "JID Visible".  For a "JID Hidden" channel, real JIDs MUST NOT be included in the participants list.    For a "JID Maybe Visible" channel, real JIDs will be included in the participants node according to participant preference. </li>
        <li class="" style="">In presence messages, the client resource is anonymized, to prevent leakage of information through the resource.</li>
      </ol>


      <p class="" style="">

This change means that the client will not be able to determine real JID of the participant using the participant node, as it can with <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>].
      </p>

      <p class="" style="">
        It is important that MUC owners and administrators are able to see the real JIDs of participant.   For this reason, a MIX channel following this specification MUST hold a JID Map node, which gives a mapping between proxy JID and real JID.
      </p>


    </div>



    <div class="indent"><h3>2.4 <a name="proxy-jid-resource" id="proxy-jid-resource">Resource Hiding</a></h3>





     <p class="" style="">
       When JIDs are being hidden, the resource of the full JIDs stored in the presence node MUST also be anonymized using a similar mechanism.
      First the bare JID in presence is a proxy JID, as defined in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>].   Where the JID is not being hidden, the resource is simply the resource of the clients full JID.   Where the JID is hidden,   the resource is replaced with a generated value.   For example,   'hag66@shakespeare.example/UUID-a1j/7533' in the channel coven might have a proxy JID of '123456#coven@mix.shakespeare.example/789'.   There is no client visible mapping of proxy full JIDs maintained as this is not needed.   The MIX channel will need to maintain a mapping, to support directly addressing clients, such as for client to client disco#info queries.  While an full proxy JID is held in the presence node, the mapping to real JID MUST NOT be changed.  When adding a client to the presence node, the server MAY add the same anonymized JID as used before by that client, or it MAY create a different anonymized JID.
     </p>
    </div>


  <div class="indent"><h3>2.5 <a name="concepts-nodes" id="concepts-nodes">JID Map Node</a></h3>
    <p class="" style="">This specification defines a JID Map node, so that administrators can see real JIDs for JID Hidden channels.</p>
    <div class="indent"><p class="caption"><a name="table-3" id="table-3"></a>Table 3: JID Map Node</p><table border="1" cellpadding="3" cellspacing="0">

      <tr class="body"><td align="" colspan="" rowspan="">JID Map</td><td align="" colspan="" rowspan="">'urn:xmpp:mix:nodes:jidmap'</td><td align="" colspan="" rowspan="">For storing a list of bare proxy JIDs from the participants node with a 1:1 mapping to the corresponding real JIDs.</td><td align="" colspan="" rowspan="">Automatic</td><td align="" colspan="" rowspan="">PubSub</td></tr>

    </table></div>





      <p class="" style="">The JID Map node is used to associate a proxy bare JID to its corresponding real bare JID.   It is a PubSub node with the 'node' attribute set to 'urn:xmpp:mix:nodes:jidmap'. The JID Map node MUST have one entry for each entry in the Participants node.  This value is added when a user joins the channel and is removed when the user leaves the channel.
       Each item is identified by proxy bare JID, mapping to the real bare JID.  This node is used to give administrator access to real JIDs and participant access to real JIDs in jid-visible channels.  This node MUST NOT be modified directly using pubsub.
       In JID Visible channels, all participants MAY subscribe to this node.  In JID Hidden and JID Maybe Visible channels, only administrators can subscribe.   The JID Map node is a permanent node with one item per participant. Information is stored in a &lt;participant/&gt; element qualified by the 'urn:xmpp:mix:anon:0' namespace.  The real JID is stored in a &lt;jid/&gt; child element of the &lt;participant/&gt; element.  </p>
      <p class="caption"><a name="example-1" id="example-1"></a>Example 1. Value of JID Map Node</p><div class="indent"><pre class="prettyprint">
&lt;items node='urn:xmpp:mix:nodes:jidmap'&gt;
  &lt;item id='123456#coven@mix.shakespeare.example'&gt;
      &lt;participant xmlns='urn:xmpp:mix:anon:0'&gt;
         &lt;jid&gt;hecate@mix.shakespeare.example&lt;/jid&gt;
      &lt;/participant&gt;
  &lt;/item&gt;
&lt;/items&gt;
</pre></div>



  </div>
<h2>3.
       <a name="usecases" id="usecases">Use Cases</a></h2>



   <div class="indent"><h3>3.1 <a name="usecase-visibilty-pref" id="usecase-visibilty-pref">User Preferences and Additional Information</a></h3>
     <p class="" style="">A channel MAY store user preferences and parameters with each user.    A user  JID visibility preference has the following values:
       </p>

     <ol start="" class="" style="">
       <li class="" style="">'default'.   In this setting, the channel default value will be used.  This value is used if another value is not explicitly set. This means JID is visible for a JID Visible channel and JID is hidden for JID Hidden and JID Maybe Visible channels.</li>
       <li class="" style="">'never'.  If this is set, JID will never be shared and user will be removed from the channel if its mode changes to JID Visible.</li>
       <li class="" style="">'always'.  If this is set, JID will always be shared and users will be removed from the channel if its mode changes to JID Hidden.</li>
       <li class="" style="">'prefer not'.   If this is set, JID will only be shared if mode is JID Visible.</li>
     </ol>
     <p class="" style="">
      The user MAY specify that no Private Messages are to be sent from the channel, and allow vCard retrieval.
     </p>
     <p class="" style="">
       The user MAY specify that presence is not to be shared, which will prevent the MIX Channel from sending a presence probe for the user on channel start-up.  The user will also choose to not include the MIX channel in the user's roster, so that presence will not be updated.    Where the channel configuration sets 'Participants Must Provide Presence', this variable MUST be set to 'Share'.
     </p>
     <p class="" style="">
       The following table sets out the standardized user preference values.   A MIX implementation MAY use other values.
     </p>
     <div class="indent"><p class="caption"><a name="table-4" id="table-4"></a>Table 4: Standard User Preference Options</p><table border="1" cellpadding="3" cellspacing="0">
       <tr class="body"><th colspan="" rowspan="">Option</th> <th colspan="" rowspan="">Values</th><th colspan="" rowspan="">Default</th></tr>
       <tr class="body"><td align="" colspan="" rowspan="">'JID Visibility'</td> <td align="" colspan="" rowspan="">'default', 'never', 'always', 'prefer not'</td>  <td align="" colspan="" rowspan="">'default'</td></tr>
       <tr class="body"><td align="" colspan="" rowspan="">'Private Messages'</td><td align="" colspan="" rowspan="">'allow', 'block'</td> <td align="" colspan="" rowspan="">'allow'</td></tr>
       <tr class="body"><td align="" colspan="" rowspan="">'vCard'</td><td align="" colspan="" rowspan="">'allow', 'block'</td> <td align="" colspan="" rowspan="">'block'</td></tr>
       <tr class="body"><td align="" colspan="" rowspan="">'Presence'</td><td align="" colspan="" rowspan="">'share', 'not share'</td><td align="" colspan="" rowspan="">'share'</td></tr>
     </table></div>
     <p class="" style="">When joining a channel, the client MAY specify one or more preference options as a <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0004.html">Data Forms (XEP-0004)</a></span>  [<a href="#nt-idm166">2</a>] form.   In the response, the  server MUST specify all of the user preferences supported by the server, with default values if the user has not requested a different value.  The following example shows joining a channel and setting a preference.  The following example shows the message sent from the user's server to the MIX channel, which will have been preceded by a message from the user's client to the user's server.</p>
     <p class="caption"><a name="example-2" id="example-2"></a>Example 2. User Joins a Channel and Specifies a preference</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='hag66@shakespeare.example'
    to='coven@mix.shakespeare.example'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
    &lt;join xmlns='urn:xmpp:mix:anon:0'&gt;
    &lt;subscribe node='urn:xmpp:mix:nodes:messages'/&gt;
    &lt;subscribe node='urn:xmpp:mix:nodes:presence'/&gt;
    &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
             &lt;value&gt;urn:xmpp:mix:anon:0&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='JID Visibility'&gt;
            &lt;value&gt;never&lt;/value&gt;
        &lt;/field&gt;
     &lt;/x&gt;
  &lt;/join&gt;
&lt;/iq&gt;
</pre></div>
     <p class="" style="">The following example shows the result of a successful join, which also reports all the user preferences. This example shows the message coming from the MIX channel to the user's server, which will be sent on to the user.</p>
     <p class="caption"><a name="example-3" id="example-3"></a>Example 3. Channel Successfully Processes Join and returns the preferences set</p><div class="indent"><pre class="prettyprint">
&lt;iq type='result'
    from='coven@mix.shakespeare.example'
    to='hag66@shakespeare.example'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
  &lt;join xmlns='urn:xmpp:mix:anon:0' jid='hag66@shakespeare.example'&gt;
    &lt;subscribe node='urn:xmpp:mix:nodes:messages'/&gt;
    &lt;subscribe node='urn:xmpp:mix:nodes:presence'/&gt;
    &lt;x xmlns='jabber:x:data' type='result'&gt;
      &lt;field var='FORM_TYPE' type='hidden'&gt;
        &lt;value&gt;urn:xmpp:mix:anon:0&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='JID Visibility'&gt;
        &lt;value&gt;never&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='Private Messages'&gt;
        &lt;value&gt;allow&lt;/value&gt;
      &lt;/field&gt;
      &lt;field var='vCard'&gt;
        &lt;value&gt;block&lt;/value&gt;
      &lt;/field&gt;
    &lt;/x&gt;
  &lt;/join&gt;
&lt;/iq&gt;
</pre></div>
     <p class="" style="">The client MAY also query the channel in order to find out which user preferences are supported and the options available.  This will allow users to set options not specified in the standard, by providing a form template in the result.  The request is encoded as a &lt;user-preference/&gt; child element of &lt;iq/&gt;.  &lt;user-preference/&gt; is qualified by the 'urn:xmpp:mix:anon:0' namespace.  The result is encoded as a form child element in the &lt;user-preference/&gt; element.</p>
     <p class="caption"><a name="example-4" id="example-4"></a>Example 4. User Requests and Recieves Preferences Template Form</p><div class="indent"><pre class="prettyprint">
&lt;iq type='get'
    from='hag66@shakespeare.example/UUID-a1j/7533'
    to='coven@mix.shakespeare.example'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
    &lt;user-preference xmlns='urn:xmpp:mix:anon:0'/&gt;
&lt;/iq&gt;

&lt;iq type='result'
    from='coven@mix.shakespeare.example'
    to='hag66@shakespeare.example/UUID-a1j/7533'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
    &lt;user-preference xmlns='urn:xmpp:mix:anon:0'&gt;
    &lt;x xmlns='jabber:x:data' type='form'&gt;
      &lt;field var='FORM_TYPE' type='hidden'&gt;
        &lt;value&gt;urn:xmpp:mix:anon:0&lt;/value&gt;
     &lt;/field&gt;
     &lt;field type='list-single' label='Preference for JID Visibility
            var='JID Visibility'&gt;
        &lt;option label='JID Never Shown'&gt;&lt;value&gt;Never&lt;/value&gt;&lt;/option&gt;
        &lt;option label='Default Behaviour'
        &lt;value&gt;default&lt;/value&gt;&lt;/option&gt;
          &lt;option label='Try not to show JID'&gt;
            &lt;value&gt;prefer not&lt;/value&gt;&lt;/option&gt;
     &lt;/field&gt;
     &lt;field type='list-single' label='Example Custom Preference'
            var='Custom Preference'&gt;
        &lt;option label='One Option'&gt;&lt;value&gt;a&lt;/value&gt;&lt;/option&gt;
        &lt;option label='Another Option'&gt;&lt;value&gt;b&lt;/value&gt;&lt;/option&gt;
      &lt;/field&gt;
    &lt;/x&gt;
  &lt;/user-preference&gt;
&lt;/iq&gt;
</pre></div>
     <p class="" style="">
       A user MAY modify preferences using the corresponding set operation.  The set MAY specify values for some or all attributes.  All attributes are returned in the result.
     </p>
     <p class="caption"><a name="example-5" id="example-5"></a>Example 5. User Updates Preferences</p><div class="indent"><pre class="prettyprint">
&lt;iq type='set'
    from='hag66@shakespeare.example/UUID-a1j/7533'
    to='coven@mix.shakespeare.example'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
    &lt;user-preference xmlns='urn:xmpp:mix:anon:0'/&gt;
     &lt;x xmlns='jabber:x:data' type='submit'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
             &lt;value&gt;urn:xmpp:mix:anon:0&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='JID Visibility'&gt;
            &lt;value&gt;never&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='Private Messages'&gt;
           &lt;value&gt;allow&lt;/value&gt;
         &lt;/field&gt;
        &lt;field var='vCard'&gt;
          &lt;value&gt;block&lt;/value&gt;
         &lt;/field&gt;
     &lt;/x&gt;
&lt;/iq&gt;

&lt;iq type='result'
    from='coven@mix.shakespeare.example'
    to='hag66@shakespeare.example/UUID-a1j/7533'
    id='E6E10350-76CF-40C6-B91B-1EA08C332FC7'&gt;
    &lt;user-preference xmlns='urn:xmpp:mix:anon:0'&gt;
    &lt;x xmlns='jabber:x:data' type='result'&gt;
        &lt;field var='FORM_TYPE' type='hidden'&gt;
             &lt;value&gt;urn:xmpp:mix:anon:0&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='JID Visibility'&gt;
            &lt;value&gt;never&lt;/value&gt;
        &lt;/field&gt;
        &lt;field var='Private Messages'&gt;
           &lt;value&gt;allow&lt;/value&gt;
         &lt;/field&gt;
        &lt;field var='vCard'&gt;
          &lt;value&gt;block&lt;/value&gt;
         &lt;/field&gt;
     &lt;/x&gt;
  &lt;/user-preference&gt;
&lt;/iq&gt;
</pre></div>
   </div>






    <div class="indent"><h3>3.2 <a name="usecase-user-private-messages" id="usecase-user-private-messages">Sending Private Messages</a></h3>

      <p class="" style="">
       Private Messages are used to provide communication with another channel participant through the MIX channel, where  the initiating  user does not the real JID of the channel participant.  A channel MAY support use of Private Messages.  Private messages are standard XMPP messages and MUST NOT be groupchat.   A message goes through a number of stages with different addressing.  This is set out in the following table.
      </p>
      <div class="indent"><p class="caption"><a name="table-5" id="table-5"></a>Table 5: Setting From and To when sending Private Messages</p><table border="1" cellpadding="3" cellspacing="0">
        <tr class="body"><th colspan="" rowspan="">Message</th><th colspan="" rowspan="">From</th><th colspan="" rowspan="">To</th></tr>
        <tr class="body"><td align="" colspan="" rowspan="">First Message from Client to MIX Channel</td><td align="" colspan="" rowspan="">Full JID of initiator's client</td><td align="" colspan="" rowspan="">Proxy bare JID of responder</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">First Message from MIX Channel to responder's server</td><td align="" colspan="" rowspan="">Proxy full JID of initiator's client</td><td align="" colspan="" rowspan="">Bare JID of responder</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">First Message from responder's server to one or more of the responder's clients</td><td align="" colspan="" rowspan="">Proxy full JID of initiator</td><td align="" colspan="" rowspan="">Full JID of responder's client</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">Messages from responder's client to MIX Channel</td><td align="" colspan="" rowspan="">Full JID of responder's client</td><td align="" colspan="" rowspan="">Proxy full JID of initiator's client</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">Messages from MIX channel to initiator's client</td><td align="" colspan="" rowspan="">Proxy full JID of responder's client</td><td align="" colspan="" rowspan="">Full JID of initiator's client</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">Messages from initiator's client to MIX Channel</td><td align="" colspan="" rowspan="">Full JID of initiator's client</td><td align="" colspan="" rowspan="">Proxy full JID of responder's client</td></tr>
        <tr class="body"><td align="" colspan="" rowspan="">Message from MIX Channel to responder's client</td><td align="" colspan="" rowspan="">Proxy full JID of initiator's client</td><td align="" colspan="" rowspan="">Full JID of responder's client</td></tr>
      </table></div>
      <p class="" style="">Private Messages MAY be archived using MAM by the XMPP servers associated with initiator and responder.   Private Messages MUST NOT be archived by the MIX channel.</p>
    </div>



    <div class="indent"><h3>3.3 <a name="usecase-vcard" id="usecase-vcard">Requesting vCard</a></h3>
      <p class="" style="">A client  MAY request the vCard of a channel participant where the participant's real JID is not known, by sending a request through the channel.  The MIX channel MAY pass this request on or MAY block it.  vCard requests MAY use <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0054.html">vcard-temp (XEP-0054)</a></span>  [<a href="#nt-idm215">3</a>] (vcard-temp) or <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0292.html">vCard4 over XMPP (XEP-0292)</a></span>  [<a href="#nt-idm219">4</a>] (vCard4 over XMPP).  The MIX channel does not process the vCard requests, but simply relays them on to real bare JID of the target.  A MIX service MAY choose to relay one or both protocols.   Where a MIX service relays  one or both of these protocols, each protocol relayed MUST be advertised as a feature of the MIX service.   In the following example, using vcard-temp, the requesting client sends a message to the  bare proxy JID of the channel participant for which the vCard is desired.</p>
      <p class="caption"><a name="example-6" id="example-6"></a>Example 6. Client directly requests vCard through channel</p><div class="indent"><pre class="prettyprint">
&lt;iq from='hag66@shakespeare.example/UUID-c8y/1573'
    id='lx09df27'
    to='989898#coven@mix.shakespeare.example'
    type='get'&gt;
  &lt;vCard xmlns='vcard-temp'/&gt;
&lt;/iq&gt;
</pre></div>
      <p class="" style="">The MIX channel MAY pass on the vCard request or MAY reject with an error, dependent on channel policy.  The MIX service will then address the vCard request to the user's server (using bare JID) using a full proxy JID to hide the requester.  </p>
      <p class="caption"><a name="example-7" id="example-7"></a>Example 7. Channel passes on vCard request to the User's Server</p><div class="indent"><pre class="prettyprint">
&lt;iq from='123456#coven@mix.shakespeare.example/6789'
    id='lx09df27'
    to='peter@shakespeare.example'
    type='get'&gt;
  &lt;vCard xmlns='vcard-temp'/&gt;
&lt;/iq&gt;
</pre></div>
    <p class="" style="">
      The user's server, on behalf of the user, MAY send a response or reject with an error.   The user's server will send the vCard back to the channel.
    </p>
      <p class="caption"><a name="example-8" id="example-8"></a>Example 8. User's Server sends vCard Response via MIX channel</p><div class="indent"><pre class="prettyprint">
&lt;iq from='peter@shakespeare.example'
    id='lx09df27'
    to='123456#coven@mix.shakespeare.example/6789'
    type='result'&gt;
    &lt;vCard xmlns='vcard-temp'&gt;
    &lt;FN&gt;Peter Saint-Andre&lt;/FN&gt;
    &lt;N&gt;
      &lt;FAMILY&gt;Saint-Andre&lt;/FAMILY&gt;
      &lt;GIVEN&gt;Peter&lt;/GIVEN&gt;
      &lt;MIDDLE/&gt;
    &lt;/N&gt;
    &lt;NICKNAME&gt;stpeter&lt;/NICKNAME&gt;
    &lt;URL&gt;http://www.xmpp.org/xsf/people/stpeter.shtml&lt;/URL&gt;
  &lt;/vCard&gt;
  &lt;query xmlns='http://jabber.org/protocol/disco#info'&gt;
&lt;/iq&gt;
</pre></div>
      <p class="" style="">
        The MIX channel will then send the vCard response to the requesting client on behalf of the client sending the response.
      </p>
      <p class="caption"><a name="example-9" id="example-9"></a>Example 9. MIX Channel sends vCard responst to Client</p><div class="indent"><pre class="prettyprint">
&lt;iq from='989898#coven@mix.shakespeare.example'
    id='lx09df27'
    to='hag66@shakespeare.example/UUID-c8y/1573'
    type='result'&gt;
 &lt;vCard xmlns='vcard-temp'&gt;
    &lt;FN&gt;Peter Saint-Andre&lt;/FN&gt;
    &lt;N&gt;
      &lt;FAMILY&gt;Saint-Andre&lt;/FAMILY&gt;
      &lt;GIVEN&gt;Peter&lt;/GIVEN&gt;
      &lt;MIDDLE/&gt;
    &lt;/N&gt;
    &lt;NICKNAME&gt;stpeter&lt;/NICKNAME&gt;
    &lt;URL&gt;http://www.xmpp.org/xsf/people/stpeter.shtml&lt;/URL&gt;
  &lt;/vCard&gt;
&lt;/iq&gt;
</pre></div>
    </div>

<h2>4.
       <a name="i18n" id="i18n">Internationalization Considerations</a></h2>
  <p class="" style="">See considerations in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>].
  </p>

<h2>5.
       <a name="security" id="security">Security Considerations</a></h2>
  <p class="" style="">See considerations in <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>].</p>



<h2>6.
       <a name="iana" id="iana">IANA Considerations</a></h2>
  <p class="" style="">None.</p>
<h2>7.
       <a name="registrar" id="registrar">XMPP Registrar Considerations</a></h2>
  <p class="" style="">The urn:xmpp:mix namespace needs to be registered.</p>
<h2>8.
       <a name="schema" id="schema">XML Schema</a></h2>
  <p class="" style="">To be supplied when MIX progresses to proposed standard.</p>
<h2>9.
       <a name="ack" id="ack">Acknowledgements</a></h2>
  <p class="" style="">See <span class="ref" style=""><a href="https://xmpp.org/extensions/xep-0369.html">Mediated Information eXchange (MIX) (XEP-0369)</a></span>  [<a href="#nt-idm57">1</a>] for a list of contributors to the MIX Family of specifications.</p>
<hr /><a name="appendices" id="appendices"></a><h2>Appendices</h2><hr /><a name="appendix-docinfo" id="appendix-docinfo"></a><h3>Appendix A: Document Information</h3><p class="indent">
            Series: <a href="http://xmpp.org/extensions/">XEP</a><br />
            Number: 0404<br />
            Publisher: <a href="/xsf/">XMPP Standards Foundation</a><br />
            Status:
            <a href="http://xmpp.org/extensions/xep-0001.html#states-Experimental">Experimental</a><br />
            Type:
            <a href="http://xmpp.org/extensions/xep-0001.html#types-Standards Track">Standards Track</a><br />
            Version: 0.1.0<br />
            Last Updated: 2018-05-21<br />
                Approving Body: <a href="http://xmpp.org/council/">XMPP Council</a><br />Dependencies: XMPP Core, XMPP IM, XEP-0004, XEP-0030, XEP-0054, XEP-0060, XEP-0084, XEP-0128, XEP-0198, XEP-0292, XEP-0297, XEP-0313, XEP-0369, XEP-0372, XEP-0403<br />
                Supersedes: None<br />
                Superseded By: None<br />
            Short Name: MIX-ANON<br />
              Source Control:
                <a class="standardsButton" href="https://github.com/xsf/xeps/blob/master/xep-0404.xml">HTML</a><br />
            This document in other formats:
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0404.xml">XML</a> 
                <a class="standardsButton" href="http://xmpp.org/extensions/xep-0404.pdf">PDF</a></p><hr /><a name="appendix-authorinfo" id="appendix-authorinfo"></a><h3>Appendix B: Author Information</h3><div class="indent"><h3>Kevin Smith</h3><p class="indent">
        Email:
        <a href="mailto:kevin.smith@isode.com">kevin.smith@isode.com</a><br />
        JabberID:
        <a href="xmpp:kevin.smith@isode.com">kevin.smith@isode.com</a><br /></p><h3>Steve Kille</h3><p class="indent">
        Email:
        <a href="mailto:steve.kille@isode.com">steve.kille@isode.com</a><br />
        JabberID:
        <a href="xmpp:steve.kille@isode.com">steve.kille@isode.com</a><br /></p></div><hr /><a name="appendix-legal" id="appendix-legal"></a><h3>Appendix C: Legal Notices</h3><div class="indent"><h4>Copyright</h4>This XMPP Extension Protocol is copyright © 1999 – 2018 by the <a href="https://xmpp.org/">XMPP Standards Foundation</a> (XSF).<h4>Permissions</h4>Permission is hereby granted, free of charge, to any person obtaining a copy of this specification (the "Specification"), to make use of the Specification without restriction, including without limitation the rights to implement the Specification in a software program, deploy the Specification in a network service, and copy, modify, merge, publish, translate, distribute, sublicense, or sell copies of the Specification, and to permit persons to whom the Specification is furnished to do so, subject to the condition that the foregoing copyright notice and this permission notice shall be included in all copies or substantial portions of the Specification. Unless separate permission is granted, modified works that are redistributed shall not contain misleading information regarding the authors, title, number, or publisher of the Specification, and shall not claim endorsement of the modified works by the authors, any organization or project to which the authors belong, or the XMPP Standards Foundation.<h4>Disclaimer of Warranty</h4><span style="font-weight: bold">## NOTE WELL: This Specification is provided on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, express or implied, including, without limitation, any warranties or conditions of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A PARTICULAR PURPOSE. ##</span><h4>Limitation of Liability</h4>In no event and under no legal theory, whether in tort (including negligence), contract, or otherwise, unless required by applicable law (such as deliberate and grossly negligent acts) or agreed to in writing, shall the XMPP Standards Foundation or any author of this Specification be liable for damages, including any direct, indirect, special, incidental, or consequential damages of any character arising from, out of, or in connection with the Specification or the implementation, deployment, or other use of the Specification (including but not limited to damages for loss of goodwill, work stoppage, computer failure or malfunction, or any and all other commercial damages or losses), even if the XMPP Standards Foundation or such author has been advised of the possibility of such damages.<h4>IPR Conformance</h4>This XMPP Extension Protocol has been contributed in full conformance with the XSF's Intellectual Property Rights Policy (a copy of which can be found at &lt;<a href="https://xmpp.org/about/xsf/ipr-policy">https://xmpp.org/about/xsf/ipr-policy</a>&gt; or obtained by writing to XMPP Standards Foundation, P.O. Box 787, Parker, CO 80134 USA).</div><hr /><a name="appendix-xmpp" id="appendix-xmpp"></a><h3>Appendix D: Relation to XMPP</h3><p class="indent">The Extensible Messaging and Presence Protocol (XMPP) is defined in the XMPP Core (RFC 6120) and XMPP IM (RFC 6121) specifications contributed by the XMPP Standards Foundation to the Internet Standards Process, which is managed by the Internet Engineering Task Force in accordance with RFC 2026. Any protocol defined in this document has been developed outside the Internet Standards Process and is to be understood as an extension to XMPP rather than as an evolution, development, or modification of XMPP itself.</p><hr /><a name="appendix-discuss" id="appendix-discuss"></a><h3>Appendix E: Discussion Venue</h3><p class="indent">The primary venue for discussion of XMPP Extension Protocols is the &lt;<a href="http://mail.jabber.org/mailman/listinfo/standards">standards@xmpp.org</a>&gt; discussion list.</p><p class="indent">Discussion on other xmpp.org discussion lists might also be appropriate; see &lt;<a href="http://xmpp.org/about/discuss.shtml">http://xmpp.org/about/discuss.shtml</a>&gt; for a complete list.</p><p class="indent">Errata can be sent to &lt;<a href="mailto:editor@xmpp.org">editor@xmpp.org</a>&gt;.</p><hr /><a name="appendix-conformance" id="appendix-conformance"></a><h3>Appendix F: Requirements Conformance</h3><p class="indent">The following requirements keywords as used in this document are to be interpreted as described in <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>: "MUST", "SHALL", "REQUIRED"; "MUST NOT", "SHALL NOT"; "SHOULD", "RECOMMENDED"; "SHOULD NOT", "NOT RECOMMENDED"; "MAY", "OPTIONAL".</p><hr /><a name="appendix-notes" id="appendix-notes"></a><h3>Appendix G: Notes</h3><div class="indent"><p><a name="nt-idm57" id="nt-idm57">1</a>. XEP-0369: Mediated Information eXchange (MIX) &lt;<a href="https://xmpp.org/extensions/xep-0369.html">https://xmpp.org/extensions/xep-0369.html</a>&gt;.</p><p><a name="nt-idm166" id="nt-idm166">2</a>. XEP-0004: Data Forms &lt;<a href="https://xmpp.org/extensions/xep-0004.html">https://xmpp.org/extensions/xep-0004.html</a>&gt;.</p><p><a name="nt-idm215" id="nt-idm215">3</a>. XEP-0054: vcard-temp &lt;<a href="https://xmpp.org/extensions/xep-0054.html">https://xmpp.org/extensions/xep-0054.html</a>&gt;.</p><p><a name="nt-idm219" id="nt-idm219">4</a>. XEP-0292: vCard4 over XMPP &lt;<a href="https://xmpp.org/extensions/xep-0292.html">https://xmpp.org/extensions/xep-0292.html</a>&gt;.</p></div><hr /><a name="appendix-revs" id="appendix-revs"></a><h3>Appendix H: Revision History</h3><p>Note: Older versions of this specification might be available at <a href="http://xmpp.org/extensions/attic/">http://xmpp.org/extensions/attic/</a></p><div class="indent"><h4>Version 0.1.0 (2018-05-21)</h4><div class="indent"><p class="" style="">
      Split out from MIX 0.10.0;
    </p> (sek)
    </div></div><hr /><p>END</p></body></html>
